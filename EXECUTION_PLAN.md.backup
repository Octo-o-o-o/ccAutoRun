# ccAutoRun v2.0 é‡æ„ - æ‰§è¡Œè®¡åˆ’

<!-- AUTO-RUN-CONFIG
stages: 7
current: 1
auto_continue: false
safety_limit: 0
task_type: refactor
estimated_time: 40-50å°æ—¶
architecture: split
-->

## ğŸ“Š ä»»åŠ¡æ¦‚è§ˆ

- **ä»»åŠ¡åç§°**: ccAutoRun v2.0 - è·¨å¹³å°æ™ºèƒ½è‡ªåŠ¨åŒ–å·¥å…·é‡æ„
- **ä»»åŠ¡ç±»å‹**: é‡æ„ + æ–°åŠŸèƒ½å¼€å‘
- **æŠ€æœ¯æ ˆ**: Node.js, Commander.js, Chokidar, node-notifier, glob, vitest
- **é¢„è®¡æ—¶é—´**: 40-50å°æ—¶ï¼ˆåˆ†7ä¸ªé˜¶æ®µï¼‰
- **æ¶æ„**: æ‹†åˆ†æ¶æ„ï¼ˆREADME.md + stages/ï¼‰
- **åˆ›å»ºæ—¶é—´**: 2025-01-06
- **é¡¹ç›®è·¯å¾„**: /Users/wangyixiao/WorkSpace/ccAutoRun

## ğŸ“‹ èƒŒæ™¯å’Œç›®æ ‡

### å½“å‰çŠ¶æ€
- æœ‰Windowsç‰ˆæœ¬ï¼ˆPowerShell + Bash + Node.jsæ··åˆï¼‰
- æœ‰MyWorkç‰ˆæœ¬ï¼ˆBash Hook + claude --resumeï¼‰
- ä¸¤å¥—æ–¹æ¡ˆå„æœ‰ä¼˜åŠ¿ä½†ä¸ç»Ÿä¸€

### ç›®æ ‡
èåˆä¸¤å¥—æ–¹æ¡ˆä¼˜åŠ¿ï¼Œåˆ›å»ºä¸€ä¸ªï¼š
1. âœ… **ä»»åŠ¡é©±åŠ¨**çš„å·¥ä½œæµå·¥å…·ï¼ˆä¸æ˜¯é¡¹ç›®åˆå§‹åŒ–ï¼‰
2. âœ… **çº¯Node.js**å®ç°ï¼Œè·¨å¹³å°ä¸€è‡´
3. âœ… **AIç”Ÿæˆè®¡åˆ’**ä¸ºæ ¸å¿ƒï¼Œç¡®ä¿é«˜è´¨é‡markdown
4. âœ… **æ–°æ‰‹å‹å¥½**ï¼Œé›¶é…ç½®å¿«é€Ÿå¯åŠ¨
5. âœ… **é€‚åˆGitHubå…¬å¼€å‘å¸ƒ**ï¼Œä¸­è‹±æ–‡åŒè¯­

### æ ¸å¿ƒåˆ›æ–°
- ğŸ¤– AIå®Œå…¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼ˆå¸¦ç¡®è®¤å’ŒReviewç¯èŠ‚ï¼‰
- ğŸ“ **æ™ºèƒ½æ¶æ„é€‰æ‹©**ï¼šæ”¯æŒæ‹†åˆ†æ¶æ„å’Œå•æ–‡ä»¶æ¶æ„ï¼ŒAIè‡ªåŠ¨åˆ¤æ–­æˆ–ç”¨æˆ·å¼ºåˆ¶æŒ‡å®š
- ğŸ¯ **æ‹†åˆ†æ¶æ„**ï¼šè®¡åˆ’README.md + è¯¦ç»†stages/ï¼ˆè§£å†³Tokenæµªè´¹é—®é¢˜ï¼Œæå‡90%æ•ˆç‡ï¼‰
- ğŸ“ **å•æ–‡ä»¶æ¶æ„**ï¼šé€‚åˆç®€å•ä»»åŠ¡ï¼ˆâ‰¤3 stagesï¼Œ<2500è¡Œï¼‰
- ğŸ“‹ å¤šä»»åŠ¡å¹¶è¡Œç®¡ç†ï¼ˆ.ccautorun/plans/ç›®å½•ï¼‰
- ğŸ”„ Hookè‡ªåŠ¨ç»§ç»­ï¼ˆclaude --resumeæ–¹å¼ï¼‰
- ğŸ”“ **è‡ªåŠ¨è·³è¿‡æƒé™**ï¼š--dangerously-skip-permissionsç¡®ä¿æ— äººå·¥å¹²é¢„
- ğŸ›¡ï¸ å¯é…ç½®å®‰å…¨é™åˆ¶
- ğŸŒ çº¯Node.jsè·¨å¹³å°

### å…³é”®è®¾è®¡å†³ç­–
**ä¸ºä»€ä¹ˆä½¿ç”¨æ‹†åˆ†æ¶æ„ï¼Ÿ**
- âœ… Tokenæ•ˆç‡æå‡90%+ï¼ˆåªåŠ è½½å½“å‰Stageï¼Œä¸æ˜¯æ•´ä¸ªè®¡åˆ’ï¼‰
- âœ… é™ä½è®¤çŸ¥è´Ÿè·ï¼ˆClaudeåªçœ‹å½“å‰Stageçš„800è¡Œï¼Œä¸æ˜¯10000è¡Œï¼‰
- âœ… æ”¯æŒæ¸è¿›å¼ç»†åŒ–ï¼ˆå…ˆç”Ÿæˆæ¦‚è¦ï¼Œå†é€æ­¥å®Œå–„ï¼‰
- âœ… å¹¶è¡Œç¼–è¾‘å‹å¥½ï¼ˆå¤šäººå¯ç¼–è¾‘ä¸åŒStageï¼‰
- âœ… å¯æ‰©å±•æ€§å¼ºï¼ˆå¤æ‚Stageå¯ä»¥è¿›ä¸€æ­¥æ‹†åˆ†ï¼‰

## ğŸ¯ æ‰§è¡Œè§„åˆ™

1. **æ‰‹åŠ¨æ‰§è¡Œæ¨¡å¼**: ç”±äºä¼šè¯çª—å£é™åˆ¶ï¼Œæ¯ä¸ªStageåœ¨æ–°çª—å£ä¸­æ‰§è¡Œ
2. **é˜¶æ®µå®Œæˆæ ‡è®°**: æ¯ä¸ªStageå®Œæˆåï¼Œåœ¨æ–°çª—å£è¾“å…¥ä¸‹ä¸€Stage
3. **è´¨é‡ä¼˜å…ˆ**: æ‰€æœ‰å®Œæˆæ ‡å‡†å¿…é¡»æ»¡è¶³
4. **å¢é‡æäº¤**: æ¯ä¸ªStageå®Œæˆågit commit

---

## Stage 1: é¡¹ç›®ç»“æ„é‡ç»„å’Œæ¸…ç† ğŸ”„

### ğŸ¯ ç›®æ ‡
æ¸…ç†ç°æœ‰æ··åˆä»£ç ï¼Œå»ºç«‹çº¯Node.jsé¡¹ç›®ç»“æ„

### ğŸ“ ä»»åŠ¡æ¸…å•
- [ ] å¤‡ä»½ç°æœ‰valuableä»£ç ï¼ˆPowerShellæ ¸å¿ƒé€»è¾‘ã€æ–‡æ¡£ï¼‰
- [ ] åˆ›å»ºæ–°çš„Node.jsé¡¹ç›®ç»“æ„
  ```
  src/
  â”œâ”€â”€ cli.js                 # CLIå…¥å£
  â”œâ”€â”€ commands/              # å‘½ä»¤å®ç°
  â”‚   â”œâ”€â”€ init.js
  â”‚   â”œâ”€â”€ plan.js
  â”‚   â”œâ”€â”€ list.js
  â”‚   â””â”€â”€ status.js
  â”œâ”€â”€ hooks/
  â”‚   â””â”€â”€ auto-continue.js   # Hookå®ç°
  â”œâ”€â”€ core/
  â”‚   â”œâ”€â”€ plan-parser.js     # è§£æè®¡åˆ’æ–‡æ¡£
  â”‚   â”œâ”€â”€ session-manager.js # ä¼šè¯ç®¡ç†
  â”‚   â””â”€â”€ safety-limiter.js  # å®‰å…¨é™åˆ¶
  â””â”€â”€ utils/
      â”œâ”€â”€ notifier.js        # é€šçŸ¥
      â”œâ”€â”€ logger.js          # æ—¥å¿—
      â”œâ”€â”€ config.js          # é…ç½®
      â”œâ”€â”€ error-handler.js   # ç»Ÿä¸€é”™è¯¯å¤„ç†
      â””â”€â”€ config-validator.js # é…ç½®éªŒè¯
  ```
- [ ] åˆ›å»ºpackage.jsonï¼Œé…ç½®ä¾èµ–
  ```json
  {
    "name": "ccautorun",
    "version": "2.0.0",
    "type": "module",
    "bin": {
      "ccautorun": "./bin/ccautorun.js"
    },
    "dependencies": {
      "commander": "^11.0.0",
      "node-notifier": "^10.0.0",
      "chokidar": "^3.5.0",
      "yaml": "^2.3.0",
      "chalk": "^5.3.0",
      "ora": "^7.0.0",
      "inquirer": "^9.2.0",
      "glob": "^10.3.0",
      "ajv": "^8.12.0",
      "winston": "^3.11.0"
    },
    "devDependencies": {
      "vitest": "^1.0.0",
      "@vitest/ui": "^1.0.0"
    }
  }
  ```
- [ ] åˆ›å»º.gitignoreï¼ˆnode_modules, *.log, .ccautorun/sessionsç­‰ï¼‰
- [ ] åˆ›å»ºbin/ccautorun.jsä½œä¸ºå…¨å±€å…¥å£
- [ ] npm installå®‰è£…ä¾èµ–

### âœ… å®Œæˆæ ‡å‡†
- [ ] é¡¹ç›®ç»“æ„ç¬¦åˆNode.jsæœ€ä½³å®è·µ
- [ ] package.jsoné…ç½®æ­£ç¡®
- [ ] æ‰€æœ‰ä¾èµ–å®‰è£…æˆåŠŸ
- [ ] binæ–‡ä»¶æœ‰æ‰§è¡Œæƒé™ï¼ˆchmod +xï¼‰
- [ ] å¯ä»¥è¿è¡Œ `node bin/ccautorun.js --help`ï¼ˆå³ä½¿åªæ˜¯ç©ºå£³ï¼‰

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `package.json` (æ–°å»º)
- [ ] `src/` ç›®å½•ç»“æ„ï¼ˆç©ºæ–‡ä»¶å ä½ï¼‰
- [ ] `bin/ccautorun.js` (å…¥å£æ–‡ä»¶)
- [ ] `.gitignore` (æ–°å»º)
- [ ] `node_modules/` (ä¾èµ–å®‰è£…)

### âš ï¸ æ³¨æ„äº‹é¡¹
- ä¸è¦åˆ é™¤ç°æœ‰çš„.claude/ã€docs/ç›®å½•ï¼Œåç»­å¯èƒ½æœ‰ç”¨
- ä½¿ç”¨ES Modulesï¼ˆ"type": "module"ï¼‰
- binæ–‡ä»¶éœ€è¦shebang: `#!/usr/bin/env node`

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# æ£€æŸ¥ç»“æ„
tree -L 2 src/

# æµ‹è¯•CLIå…¥å£
node bin/ccautorun.js --version

# æ£€æŸ¥ä¾èµ–
npm list --depth=0
```

---

## Stage 2a: æ ¸å¿ƒCLIæ¡†æ¶å’ŒåŸºç¡€å‘½ä»¤ ğŸ”„

### ğŸ¯ ç›®æ ‡
å®ç°CLIå‘½ä»¤æ¡†æ¶ã€åŸºç¡€å‘½ä»¤ï¼ˆinit, list, status, doctorï¼‰å’Œè¾…åŠ©å·¥å…·

### ğŸ“ ä»»åŠ¡æ¸…å•
- [ ] å®ç° `src/cli.js` ä½¿ç”¨Commander.js
  - å®šä¹‰æ‰€æœ‰å‘½ä»¤ç»“æ„
  - ç‰ˆæœ¬å·ã€å¸®åŠ©ä¿¡æ¯
  - å…¨å±€é€‰é¡¹ï¼ˆ--verbose, --dry-run, --configç­‰ï¼‰
  - **é¦–æ¬¡è¿è¡Œæ£€æµ‹**ï¼šå¦‚æœæœªåˆå§‹åŒ–ï¼ˆæ²¡æœ‰ .ccautorun/ï¼‰ï¼Œæ˜¾ç¤ºäº¤äº’å¼ Onboarding
- [ ] å®ç°äº¤äº’å¼ Onboardingï¼ˆé¦–æ¬¡è¿è¡Œæ—¶ï¼‰
  - æ¬¢è¿ç•Œé¢ï¼š`Welcome to ccAutoRun! ğŸ‘‹`
  - æä¾›é€‰é¡¹ï¼š
    1. Initialize project (ccautorun init)
    2. Generate your first plan (claude "/plan <description>")
    3. Read documentation (opens docs link)
  - æ ¹æ®ç”¨æˆ·é€‰æ‹©æ‰§è¡Œå¯¹åº”æ“ä½œ
- [ ] å®ç° `ccautorun init` å‘½ä»¤ï¼ˆå¢å¼ºç‰ˆï¼‰
  - æ”¯æŒ `--dry-run` é¢„è§ˆå°†è¦åˆ›å»ºçš„æ–‡ä»¶
  - åœ¨å½“å‰é¡¹ç›®åˆ›å»º `.ccautorun/` ç›®å½•
  - åˆ›å»º `plans/`, `sessions/`, `logs/`, `archive/` å­ç›®å½•
  - åˆ›å»ºé»˜è®¤ `config.yaml`ï¼š
    ```yaml
    version: "2.0.0"
    default_architecture: auto  # auto=è‡ªåŠ¨åˆ¤æ–­, split=å¼ºåˆ¶æ‹†åˆ†, single=å¼ºåˆ¶å•æ–‡ä»¶
    safety_limit: unlimited
    notifications:
      enabled: true
      sound: true
      progress_frequency: every-stage  # every-stage / every-2-stages / off
    auto_continue:
      enabled: true
      skip_permissions: true  # è‡ªåŠ¨ç»§ç»­æ—¶è·³è¿‡æƒé™ç¡®è®¤ï¼ˆå…³é”®ï¼ï¼‰
    editor: "code"  # æ‰“å¼€è®¡åˆ’æ–‡æ¡£çš„ç¼–è¾‘å™¨
    language: en    # CLI è¾“å‡ºè¯­è¨€ï¼ˆä»… enï¼‰
    ```
  - **è‡ªåŠ¨é…ç½® Claude Code hooks**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
    - æ”¯æŒ `--setup-hooks` è‡ªåŠ¨åˆ›å»ºå¹¶é…ç½® `.claude/hooks.yaml`
    - æ”¯æŒ `--enable-hooks` è‡ªåŠ¨å¯ç”¨ auto-continue hook
    - å¦‚æœ `.claude/hooks.yaml` ä¸å­˜åœ¨ï¼Œåˆ›å»ºå¹¶é…ç½®
    - å¦‚æœå­˜åœ¨ä½† hook æœªå¯ç”¨ï¼Œäº¤äº’å¼è¯¢é—®ç”¨æˆ·æ˜¯å¦å¯ç”¨
    - æç¤ºï¼šåˆ¶å®šè®¡åˆ’ä¸éœ€è¦ hookï¼Œæ‰§è¡Œæ—¶æ‰éœ€è¦
- [ ] å®ç° `ccautorun list` å‘½ä»¤
  - æ‰«æ `.ccautorun/plans/` ç›®å½•
  - **æ”¯æŒä¸¤ç§æ ¼å¼**ï¼šå•æ–‡ä»¶ï¼ˆxxx.mdï¼‰å’Œæ‹†åˆ†æ¶æ„ï¼ˆxxx/README.mdï¼‰
  - è§£ææ¯ä¸ªè®¡åˆ’çš„é…ç½®å¤´
  - æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨ï¼ˆè¿›åº¦ã€çŠ¶æ€ã€æœ€åæ›´æ–°æ—¶é—´ã€æ¶æ„ç±»å‹ï¼‰
- [ ] å®ç° `ccautorun status [task-name]` å‘½ä»¤
  - æ˜¾ç¤ºæŒ‡å®šä»»åŠ¡çš„è¯¦ç»†çŠ¶æ€
  - å½“å‰é˜¶æ®µã€ä¼šè¯è®¡æ•°ã€å®Œæˆç™¾åˆ†æ¯”
  - **æ‹†åˆ†æ¶æ„æ˜¾ç¤º**ï¼šåˆ—å‡ºæ‰€æœ‰stages/æ–‡ä»¶
- [ ] å®ç° `ccautorun doctor` å‘½ä»¤ï¼ˆè¯Šæ–­å·¥å…·ï¼Œå…³é”®ï¼ï¼‰
  - æ”¯æŒ `--dry-run` é¢„è§ˆä¿®å¤æ“ä½œ
  - æ”¯æŒ `--fix` è‡ªåŠ¨ä¿®å¤å¸¸è§é—®é¢˜
  - æ£€æŸ¥ Claude CLI æ˜¯å¦å®‰è£…ï¼ˆè·¨å¹³å°æ£€æµ‹ï¼‰
  - **æ£€æŸ¥ Claude CLI ç‰ˆæœ¬**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
    - æ‰§è¡Œ `claude --version` è·å–ç‰ˆæœ¬å·
    - æ£€æŸ¥æ˜¯å¦æ»¡è¶³æœ€ä½ç‰ˆæœ¬è¦æ±‚ï¼ˆå¦‚ v1.0.0+ï¼‰
    - ç‰ˆæœ¬è¿‡æ—§æ—¶ç»™å‡ºå‡çº§å»ºè®®
  - æ£€æŸ¥ `.claude/hooks.yaml` æ˜¯å¦æ­£ç¡®é…ç½®
  - æ£€æŸ¥ auto-continue hook æ˜¯å¦å¯ç”¨
  - æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆ>= 18ï¼‰
  - æ£€æŸ¥ `.ccautorun/` ç›®å½•æƒé™
  - éªŒè¯å½“å‰ä»»åŠ¡çŠ¶æ€ï¼ˆå¦‚æœæŒ‡å®šä»»åŠ¡ï¼‰
  - éªŒè¯è®¡åˆ’æ–‡æ¡£æ ¼å¼ï¼ˆå¦‚æœæŒ‡å®šä»»åŠ¡ï¼‰
  - è¾“å‡ºè¯Šæ–­æŠ¥å‘Šå’Œä¿®å¤å»ºè®®
  - **è‡ªåŠ¨ä¿®å¤**ï¼ˆ--fix æ¨¡å¼ï¼‰ï¼š
    - åˆ›å»ºç¼ºå¤±çš„ç›®å½•
    - ä¿®å¤é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯
    - å¯ç”¨ auto-continue hook
- [ ] å®ç° `ccautorun edit <task-name>` å‘½ä»¤ï¼ˆå¿«æ·ç¼–è¾‘ï¼‰
  - æ”¯æŒ `--dry-run` é¢„è§ˆå°†è¦æ‰“å¼€çš„æ–‡ä»¶
  - åœ¨é…ç½®çš„ç¼–è¾‘å™¨ä¸­æ‰“å¼€è®¡åˆ’æ–‡æ¡£
  - **æ‹†åˆ†æ¶æ„**ï¼šæ‰“å¼€ `README.md`ï¼ˆæˆ–ç”¨æˆ·æŒ‡å®šçš„ stage æ–‡ä»¶ï¼‰
  - **å•æ–‡ä»¶**ï¼šæ‰“å¼€ `task-name.md`
  - æ”¯æŒ `--stage N` æ‰“å¼€æŒ‡å®š stage æ–‡ä»¶ï¼ˆä»…æ‹†åˆ†æ¶æ„ï¼‰
  - ä» config.yaml è¯»å–é»˜è®¤ç¼–è¾‘å™¨ï¼ˆcode/vim/nanoç­‰ï¼‰
  - æ”¯æŒ `--editor <name>` ä¸´æ—¶æŒ‡å®šç¼–è¾‘å™¨
- [ ] å®ç° `ccautorun validate <task-name>` å‘½ä»¤ï¼ˆè®¡åˆ’éªŒè¯ï¼‰
  - æ”¯æŒ `--dry-run` é¢„è§ˆéªŒè¯æ“ä½œ
  - éªŒè¯è®¡åˆ’æ–‡æ¡£æ ¼å¼ï¼š
    - é…ç½®å¤´æ˜¯å¦å®Œæ•´ï¼ˆstages/current/architectureç­‰ï¼‰
    - Stage æ–‡ä»¶å‘½åæ˜¯å¦è§„èŒƒï¼ˆæ‹†åˆ†æ¶æ„ï¼‰
    - Stage æ•°é‡æ˜¯å¦åŒ¹é…é…ç½®
    - æ–‡ä»¶å†…å®¹ç»“æ„æ˜¯å¦å®Œæ•´ï¼ˆç›®æ ‡/ä»»åŠ¡æ¸…å•/å®Œæˆæ ‡å‡†ç­‰ï¼‰
  - Token æ•ˆç‡æ£€æŸ¥ï¼š
    - å•ä¸ª Stage æ˜¯å¦è¶…è¿‡ 1500 tokensï¼ˆæ‹†åˆ†æ¶æ„ï¼‰
    - å•æ–‡ä»¶æ˜¯å¦è¶…è¿‡ 5000 tokens
  - ç»™å‡ºå…·ä½“çš„ä¿®å¤å»ºè®®
  - è¾“å‡ºéªŒè¯æŠ¥å‘Š
- [ ] å®ç° `ccautorun recover <task-name>` å‘½ä»¤ï¼ˆé”™è¯¯æ¢å¤ï¼‰
  - æ”¯æŒ `--dry-run` é¢„è§ˆæ¢å¤æ“ä½œ
  - ä»é”™è¯¯çŠ¶æ€æ¢å¤ä»»åŠ¡ï¼š
    - æ£€æŸ¥å¹¶ä¿®å¤ä¼šè¯çŠ¶æ€æ–‡ä»¶
    - é‡æ–°åŒæ­¥è®¡åˆ’æ–‡æ¡£å’Œä¼šè¯çŠ¶æ€
    - ä¿®å¤ README.md çš„ current å­—æ®µï¼ˆæ‹†åˆ†æ¶æ„ï¼‰
  - æä¾›äº¤äº’å¼æ¢å¤å‘å¯¼ï¼š
    - æ˜¾ç¤ºå½“å‰é—®é¢˜
    - æä¾›å¤šä¸ªæ¢å¤é€‰é¡¹
    - ç”¨æˆ·ç¡®è®¤åæ‰§è¡Œ
  - å¤‡ä»½åŸå§‹çŠ¶æ€ï¼Œæ”¯æŒå›æ»š
- [ ] å®ç° `src/utils/logger.js`ï¼ˆä½¿ç”¨ winstonï¼‰
  - å½©è‰²è¾“å‡ºï¼ˆchalk + winston transportsï¼‰
  - æ—¥å¿—çº§åˆ«ï¼ˆinfo, warn, error, debugï¼‰
  - æ–‡ä»¶æ—¥å¿—ï¼ˆå†™å…¥.ccautorun/logs/ï¼‰
  - **æ—¥å¿—è½®è½¬**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
    - ä½¿ç”¨ winston-daily-rotate-file
    - é…ç½®ï¼šæœ€å¤šä¿ç•™ 30 å¤©æˆ– 100MB
    - æŒ‰æ—¥æœŸå½’æ¡£ï¼ˆexecution-2025-01-06.logï¼‰
  - æ”¯æŒ --verbose å…¨å±€é€‰é¡¹
  - ç»Ÿä¸€æ—¥å¿—æ ¼å¼ï¼ˆæ—¶é—´æˆ³ + çº§åˆ« + æ¶ˆæ¯ï¼‰
- [ ] å®ç° `src/utils/config.js`
  - è¯»å–/å†™å…¥é…ç½®æ–‡ä»¶
  - é»˜è®¤é…ç½®ç®¡ç†
  - æ”¯æŒé…ç½®åˆå¹¶ï¼ˆç”¨æˆ·é…ç½®è¦†ç›–é»˜è®¤é…ç½®ï¼‰
- [ ] å®ç° `src/utils/config-validator.js`
  - ä½¿ç”¨ ajv éªŒè¯ config.yaml æ ¼å¼
  - å®šä¹‰ JSON Schema
  - æä¾›æ¸…æ™°çš„éªŒè¯é”™è¯¯æç¤º
  - æ”¯æŒé…ç½®ç‰ˆæœ¬æ£€æŸ¥
- [ ] å®ç° `src/utils/error-handler.js`
  - ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ ¼å¼åŒ–
  - é”™è¯¯åˆ†ç±»ï¼ˆç”¨æˆ·é”™è¯¯ vs ç³»ç»Ÿé”™è¯¯ï¼‰
  - é”™è¯¯ä»£ç ç³»ç»Ÿï¼ˆE001, E002...ï¼‰
  - æä¾›ä¸Šä¸‹æ–‡ç›¸å…³çš„ä¿®å¤å»ºè®®
  - å‹å¥½çš„é”™è¯¯æ¶ˆæ¯æ¨¡æ¿

### âœ… å®Œæˆæ ‡å‡†
- [ ] é¦–æ¬¡è¿è¡Œæ˜¾ç¤ºäº¤äº’å¼ Onboarding
- [ ] `ccautorun --help` æ˜¾ç¤ºå®Œæ•´å¸®åŠ©
- [ ] `ccautorun init` å¯ä»¥æˆåŠŸåˆå§‹åŒ–é¡¹ç›®
- [ ] **init æ”¯æŒ --dry-run é¢„è§ˆ**
- [ ] **init æ”¯æŒ --setup-hooks å’Œ --enable-hooks è‡ªåŠ¨é…ç½®**
- [ ] init å¯ä»¥è‡ªåŠ¨åˆ›å»ºå’Œé…ç½® `.claude/hooks.yaml`
- [ ] init å¯ä»¥äº¤äº’å¼è¯¢é—®æ˜¯å¦å¯ç”¨ hook
- [ ] åˆå§‹åŒ–åç›®å½•ç»“æ„æ­£ç¡®ï¼ˆåŒ…å« archive/ ç›®å½•ï¼‰
- [ ] config.yaml åŒ…å« version å­—æ®µå’Œæ–°é…ç½®é¡¹
- [ ] config.yaml éªŒè¯å¯ä»¥æ•è·æ ¼å¼é”™è¯¯å¹¶ç»™å‡ºæ¸…æ™°æç¤º
- [ ] `ccautorun list` å¯ä»¥åˆ—å‡ºè®¡åˆ’ï¼ˆå³ä½¿ä¸ºç©ºï¼‰
- [ ] `ccautorun status` å¯ä»¥æ˜¾ç¤ºçŠ¶æ€
- [ ] `ccautorun doctor` å¯ä»¥æ£€æŸ¥æ‰€æœ‰ä¾èµ–å¹¶è¾“å‡ºè¯Šæ–­æŠ¥å‘Š
- [ ] **doctor å¯ä»¥æ£€æŸ¥ Claude CLI ç‰ˆæœ¬å¹¶ç»™å‡ºå‡çº§å»ºè®®**
- [ ] **doctor æ”¯æŒ --dry-run å’Œ --fix è‡ªåŠ¨ä¿®å¤**
- [ ] **edit å‘½ä»¤å¯ä»¥æ‰“å¼€è®¡åˆ’æ–‡æ¡£**ï¼ˆæ”¯æŒ --stage Nï¼‰
- [ ] **validate å‘½ä»¤å¯ä»¥éªŒè¯è®¡åˆ’æ ¼å¼å’Œ token æ•ˆç‡**
- [ ] **recover å‘½ä»¤å¯ä»¥ä»é”™è¯¯çŠ¶æ€æ¢å¤ä»»åŠ¡**
- [ ] é”™è¯¯å¤„ç†ç»Ÿä¸€ä¸”å‹å¥½ï¼ŒåŒ…å«é”™è¯¯ä»£ç å’Œä¿®å¤å»ºè®®
- [ ] **æ—¥å¿—æ”¯æŒè½®è½¬**ï¼ˆwinston-daily-rotate-fileï¼‰
- [ ] æ—¥å¿—æ­£ç¡®è¾“å‡ºåˆ°æ–‡ä»¶å’Œæ§åˆ¶å°
- [ ] **æ‰€æœ‰å‘½ä»¤æ”¯æŒ --dry-run å…¨å±€é€‰é¡¹**
- [ ] æ”¯æŒ --verbose å…¨å±€é€‰é¡¹
- [ ] æ— TypeScript/ESLinté”™è¯¯

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `src/cli.js` (300è¡Œï¼Œå¢åŠ  Onboarding å’Œå…¨å±€é€‰é¡¹ï¼‰
- [ ] `src/commands/init.js` (250è¡Œï¼Œå¢åŠ  hook è‡ªåŠ¨é…ç½®ï¼‰
- [ ] `src/commands/list.js` (150è¡Œ)
- [ ] `src/commands/status.js` (100è¡Œ)
- [ ] `src/commands/doctor.js` (300è¡Œï¼Œå¢åŠ ç‰ˆæœ¬æ£€æŸ¥å’Œ --fixï¼‰
- [ ] `src/commands/edit.js` (120è¡Œï¼Œæ–°å¢ï¼‰
- [ ] `src/commands/validate.js` (200è¡Œï¼Œæ–°å¢ï¼‰
- [ ] `src/commands/recover.js` (180è¡Œï¼Œæ–°å¢ï¼‰
- [ ] `src/utils/logger.js` (150è¡Œï¼Œå¢åŠ  winston å’Œæ—¥å¿—è½®è½¬ï¼‰
- [ ] `src/utils/config.js` (80è¡Œï¼Œæ·»åŠ åˆå¹¶é€»è¾‘ï¼‰
- [ ] `src/utils/config-validator.js` (120è¡Œï¼Œæ–°å¢ï¼‰
- [ ] `src/utils/error-handler.js` (150è¡Œï¼Œæ–°å¢ï¼‰

### âš ï¸ æ³¨æ„äº‹é¡¹
- Commander.js v11ä½¿ç”¨ES Modulesè¯­æ³•
- chalk v5ä¹Ÿæ˜¯çº¯ESMï¼Œæ³¨æ„importæ–¹å¼
- winston éœ€è¦é…ç½® winston-daily-rotate-file
- å½©è‰²è¾“å‡ºè€ƒè™‘ç»ˆç«¯å…¼å®¹æ€§
- **é”™è¯¯å¤„ç†è‡³å…³é‡è¦**ï¼šç»Ÿä¸€ä½¿ç”¨ error-handlerï¼ŒåŒ…å«é”™è¯¯ä»£ç å’Œä¿®å¤å»ºè®®
- **é…ç½®éªŒè¯**ï¼šä½¿ç”¨ ajvï¼Œå®šä¹‰å®Œæ•´çš„ JSON Schema
- **doctor å‘½ä»¤æ˜¯å…³é”®**ï¼šåº”è¯¥æ˜¯ç”¨æˆ·é‡åˆ°é—®é¢˜æ—¶çš„ç¬¬ä¸€é€‰æ‹©
- **--dry-run å…¨å±€æ”¯æŒ**ï¼šæ‰€æœ‰æœ‰å‰¯ä½œç”¨çš„å‘½ä»¤éƒ½åº”æ”¯æŒ
- **hook è‡ªåŠ¨é…ç½®æ˜¯ç”¨æˆ·ä½“éªŒå…³é”®**ï¼šé™ä½é¦–æ¬¡ä½¿ç”¨é—¨æ§›
- **CLI è¾“å‡ºè¯­è¨€**ï¼šæ‰€æœ‰è¾“å‡ºåªä½¿ç”¨è‹±è¯­ï¼Œä¸åšå¤šè¯­è¨€æ”¯æŒ
- **Windows å…¼å®¹æ€§**ï¼šé¿å…ä½¿ç”¨ shell ç‰¹å®šå‘½ä»¤ï¼ˆå¦‚ whichï¼‰ï¼Œä½¿ç”¨ Node.js API
- **Onboarding åº”ç®€æ´æ˜äº†**ï¼š3 ä¸ªé€‰é¡¹ï¼Œå¿«é€Ÿä¸Šæ‰‹
- **edit å‘½ä»¤è·¨å¹³å°**ï¼šæ£€æµ‹å¯ç”¨ç¼–è¾‘å™¨ï¼ˆcode/vim/nanoç­‰ï¼‰

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# æµ‹è¯•é¦–æ¬¡è¿è¡Œ Onboarding
rm -rf .ccautorun
ccautorun
# åº”æ˜¾ç¤ºæ¬¢è¿ç•Œé¢å’Œ3ä¸ªé€‰é¡¹

# æµ‹è¯• initï¼ˆå…³é”®ï¼ï¼‰
cd /tmp/test-project
ccautorun init --dry-run          # é¢„è§ˆ
ccautorun init --setup-hooks      # è‡ªåŠ¨é…ç½® hook
ccautorun init --enable-hooks     # è‡ªåŠ¨å¯ç”¨ hook
# åº”è‡ªåŠ¨åˆ›å»ºå¹¶é…ç½® .claude/hooks.yaml

# æµ‹è¯• doctorï¼ˆå…³é”®ï¼ï¼‰
ccautorun doctor
# åº”è¾“å‡ºï¼šNode.js ç‰ˆæœ¬ã€Claude CLI ç‰ˆæœ¬ã€Hook é…ç½®çŠ¶æ€ç­‰

ccautorun doctor --dry-run        # é¢„è§ˆä¿®å¤
ccautorun doctor --fix            # è‡ªåŠ¨ä¿®å¤
# åº”è‡ªåŠ¨ä¿®å¤å¸¸è§é—®é¢˜

# éªŒè¯é…ç½®æ–‡ä»¶
cat .ccautorun/config.yaml
# åº”åŒ…å« version: "2.0.0" å’Œæ‰€æœ‰æ–°é…ç½®é¡¹

# æµ‹è¯•é…ç½®éªŒè¯
echo "invalid: [" >> .ccautorun/config.yaml
ccautorun list
# åº”æ˜¾ç¤ºæ¸…æ™°çš„é…ç½®éªŒè¯é”™è¯¯

# æµ‹è¯• list
ccautorun list

# æµ‹è¯• status
ccautorun status

# æµ‹è¯•æ–°å‘½ä»¤
ccautorun edit test-task                    # æ‰“å¼€ README.md
ccautorun edit test-task --stage 2          # æ‰“å¼€ stage 2
ccautorun validate test-task                # éªŒè¯è®¡åˆ’æ ¼å¼
ccautorun recover test-task --dry-run       # é¢„è§ˆæ¢å¤
ccautorun recover test-task                 # æ‰§è¡Œæ¢å¤

# æµ‹è¯•å¸®åŠ©
ccautorun --help
ccautorun init --help
ccautorun doctor --help
ccautorun edit --help
ccautorun validate --help

# æµ‹è¯•å…¨å±€é€‰é¡¹
ccautorun --verbose list
ccautorun --dry-run init

# éªŒè¯æ—¥å¿—è½®è½¬
ls -lh .ccautorun/logs/
# åº”çœ‹åˆ°æŒ‰æ—¥æœŸå½’æ¡£çš„æ—¥å¿—æ–‡ä»¶
```

---

## Stage 2b: CLIå¢å¼ºå‘½ä»¤å’Œé…ç½®ç®¡ç† ğŸ”„

### ğŸ¯ ç›®æ ‡
å®ç°å¢å¼ºå‘½ä»¤ï¼ˆpause/resume/skip/retry/logs/statsï¼‰å’Œé…ç½®ç®¡ç†åŠŸèƒ½

### ğŸ“ ä»»åŠ¡æ¸…å•
- [ ] å®ç° `ccautorun pause <task-name>` å‘½ä»¤
  - æ”¯æŒ `--dry-run` é¢„è§ˆæ“ä½œ
  - æš‚åœæŒ‡å®šä»»åŠ¡çš„è‡ªåŠ¨ç»§ç»­
  - ä¿®æ”¹ä¼šè¯çŠ¶æ€ä¸º paused
  - æç¤ºç”¨æˆ·å¯ä½¿ç”¨ resume æ¢å¤
- [ ] å®ç° `ccautorun resume <task-name>` å‘½ä»¤
  - æ”¯æŒ `--dry-run` é¢„è§ˆæ“ä½œ
  - æ¢å¤å·²æš‚åœä»»åŠ¡çš„è‡ªåŠ¨ç»§ç»­
  - ä¿®æ”¹ä¼šè¯çŠ¶æ€ä¸º active
- [ ] å®ç° `ccautorun skip <task-name> <stage-number>` å‘½ä»¤
  - æ”¯æŒ `--dry-run` é¢„è§ˆæ“ä½œ
  - è·³è¿‡æŒ‡å®š Stageï¼Œæ›´æ–°è¿›åº¦åˆ°ä¸‹ä¸€ä¸ª
  - è®°å½•è·³è¿‡åŸå› ï¼ˆå¯é€‰å‚æ•° `--reason "..."`ï¼‰
  - è­¦å‘Šï¼šè·³è¿‡å¯èƒ½å¯¼è‡´åç»­ Stage å¤±è´¥
- [ ] å®ç° `ccautorun retry <task-name> [stage-number]` å‘½ä»¤
  - æ”¯æŒ `--dry-run` é¢„è§ˆæ“ä½œ
  - é‡è¯•å¤±è´¥çš„ Stage
  - å¦‚æœä¸æŒ‡å®š stage-numberï¼Œé‡è¯•å½“å‰ Stage
  - é‡ç½®ä¼šè¯è®¡æ•°ï¼ˆå¯é€‰ `--reset-count`ï¼‰
  - ä» failed çŠ¶æ€æ¢å¤ä»»åŠ¡
- [ ] å®ç° `ccautorun logs <task-name>` å‘½ä»¤
  - æ˜¾ç¤ºä»»åŠ¡æ‰§è¡Œæ—¥å¿—
  - æ”¯æŒ `--tail N` åªæ˜¾ç¤ºæœ€å N è¡Œ
  - æ”¯æŒ `--follow` å®æ—¶è·Ÿè¸ª
  - æ”¯æŒ `--level <level>` è¿‡æ»¤æ—¥å¿—çº§åˆ«
- [ ] å®ç° `ccautorun stats` å‘½ä»¤
  - æ˜¾ç¤ºå…¨å±€ç»Ÿè®¡ä¿¡æ¯ï¼š
    - æ€»ä»»åŠ¡æ•°ï¼ˆè¿›è¡Œä¸­/å·²å®Œæˆ/å·²å¤±è´¥/å·²å½’æ¡£ï¼‰
    - å¹³å‡æ¯ä»»åŠ¡å®Œæˆæ—¶é—´
    - Stage å®ŒæˆæˆåŠŸç‡
    - æœ€å¸¸ä½¿ç”¨çš„å‘½ä»¤ï¼ˆå¦‚æœæœ‰æ—¥å¿—ï¼‰
  - æ˜¾ç¤ºå•ä¸ªä»»åŠ¡ç»Ÿè®¡ï¼ˆ`--task <name>`ï¼‰
  - æ”¯æŒ `--format json` è¾“å‡º JSON æ ¼å¼
- [ ] å®ç° `ccautorun config` å‘½ä»¤ï¼ˆå¢å¼ºç‰ˆï¼‰
  - äº¤äº’å¼é…ç½®å‘å¯¼ï¼ˆinquirerï¼‰
  - é…ç½®é¡¹ï¼š
    - é»˜è®¤æ¶æ„ç±»å‹ï¼ˆauto/split/singleï¼‰
    - å®‰å…¨é™åˆ¶ç­–ç•¥ï¼ˆunlimited/æ•°å­—ï¼‰
    - é€šçŸ¥åå¥½ï¼ˆenabled, sound, progress_frequencyï¼‰
    - è‡ªåŠ¨ç»§ç»­å¼€å…³ï¼ˆenabled, skip_permissionsï¼‰
    - é»˜è®¤ç¼–è¾‘å™¨ï¼ˆcode, vim, etcï¼‰
  - æ”¯æŒ `--get <key>` æŸ¥è¯¢å•ä¸ªé…ç½®ï¼ˆåµŒå¥—é”®ï¼š`notifications.enabled`ï¼‰
  - æ”¯æŒ `--set <key> <value>` ä¿®æ”¹å•ä¸ªé…ç½®
  - æ”¯æŒ `--list` åˆ—å‡ºæ‰€æœ‰é…ç½®
  - æ”¯æŒ `--dry-run` é¢„è§ˆä¿®æ”¹
  - é…ç½®éªŒè¯ï¼ˆä½¿ç”¨ config-validatorï¼‰
  - ä¿å­˜åˆ° `.ccautorun/config.yaml`

### âœ… å®Œæˆæ ‡å‡†
- [ ] `ccautorun pause/resume` å‘½ä»¤å¯ä»¥æ­£å¸¸å·¥ä½œ
- [ ] `ccautorun skip` å¯ä»¥è·³è¿‡ Stage å¹¶è®°å½•åŸå› 
- [ ] `ccautorun retry` å¯ä»¥ä» failed çŠ¶æ€æ¢å¤
- [ ] retry æ”¯æŒé‡ç½®ä¼šè¯è®¡æ•°
- [ ] `ccautorun logs` å¯ä»¥æ˜¾ç¤ºä»»åŠ¡æ—¥å¿—
- [ ] logs æ”¯æŒ --tail, --follow, --level é€‰é¡¹
- [ ] `ccautorun stats` å¯ä»¥æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
- [ ] stats å¯ä»¥æ˜¾ç¤ºå¤±è´¥ä»»åŠ¡æ•°é‡
- [ ] stats æ”¯æŒ --format json
- [ ] config å‘½ä»¤å¯ä»¥äº¤äº’å¼é…ç½®æ‰€æœ‰é¡¹
- [ ] config æ”¯æŒ --get/--set/--list å­å‘½ä»¤
- [ ] config æ”¯æŒåµŒå¥—é”®ï¼ˆå¦‚ `notifications.enabled`ï¼‰
- [ ] é…ç½®ä¿å­˜åˆ° yaml æ–‡ä»¶å¹¶é€šè¿‡éªŒè¯
- [ ] **æ‰€æœ‰å‘½ä»¤æ”¯æŒ --dry-run**
- [ ] æ‰€æœ‰å‘½ä»¤æœ‰å®Œå–„çš„é”™è¯¯å¤„ç†

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `src/commands/pause.js` (80è¡Œï¼Œå¢åŠ  --dry-runï¼‰
- [ ] `src/commands/resume.js` (80è¡Œï¼Œå¢åŠ  --dry-runï¼‰
- [ ] `src/commands/skip.js` (120è¡Œï¼Œå¢åŠ  --reason å’Œ --dry-runï¼‰
- [ ] `src/commands/retry.js` (150è¡Œï¼Œå¢åŠ  failed çŠ¶æ€å¤„ç†å’Œ --dry-runï¼‰
- [ ] `src/commands/logs.js` (150è¡Œï¼Œå¢åŠ  --level å’Œ --followï¼‰
- [ ] `src/commands/stats.js` (200è¡Œï¼Œå¢åŠ  --format jsonï¼‰
- [ ] `src/commands/config.js` (300è¡Œï¼Œå¢åŠ  --get/--set/--listï¼‰

### âš ï¸ æ³¨æ„äº‹é¡¹
- **dry-run æ˜¯å…³é”®**ï¼šæ‰€æœ‰å‘½ä»¤éƒ½è¦æ”¯æŒï¼Œç”¨æˆ·å¯ä»¥é¢„è§ˆæ“ä½œ
- **retry å¿…é¡»å¤„ç† failed çŠ¶æ€**ï¼šè¿™æ˜¯é”™è¯¯æ¢å¤çš„é‡è¦é€”å¾„
- **config --get/--set**ï¼šæ”¯æŒåµŒå¥—é”®ï¼Œä½¿ç”¨ lodash.get/set æˆ–ç±»ä¼¼æ–¹æ³•
- **stats çš„ JSON è¾“å‡º**ï¼šæ–¹ä¾¿é›†æˆåˆ°å…¶ä»–å·¥å…·
- **logs --follow**ï¼šä½¿ç”¨ tail -f æˆ– chokidar å®æ—¶ç›‘æ§æ—¥å¿—æ–‡ä»¶
- **Windows å…¼å®¹æ€§**ï¼šä½¿ç”¨ Node.js API

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# æµ‹è¯• pause/resume
ccautorun pause test-task --dry-run
ccautorun pause test-task
ccautorun resume test-task

# æµ‹è¯• skip
ccautorun skip test-task 3 --reason "Stage 3 not needed" --dry-run
ccautorun skip test-task 3 --reason "Stage 3 not needed"

# æµ‹è¯• retry
ccautorun retry test-task --dry-run
ccautorun retry test-task
ccautorun retry test-task 2 --reset-count

# æµ‹è¯• logs
ccautorun logs test-task
ccautorun logs test-task --tail 20
ccautorun logs test-task --follow
ccautorun logs test-task --level error

# æµ‹è¯• stats
ccautorun stats
ccautorun stats --task test-task
ccautorun stats --format json

# æµ‹è¯• config
ccautorun config                                    # äº¤äº’å¼
ccautorun config --list                             # åˆ—å‡ºæ‰€æœ‰é…ç½®
ccautorun config --get default_architecture         # æŸ¥è¯¢å•ä¸ª
ccautorun config --get notifications.enabled        # åµŒå¥—é”®
ccautorun config --set editor vim --dry-run         # é¢„è§ˆ
ccautorun config --set notifications.sound false    # è®¾ç½®

# æµ‹è¯•å¸®åŠ©
ccautorun pause --help
ccautorun retry --help
ccautorun config --help
```

---

## Stage 3: æ ¸å¿ƒè‡ªåŠ¨åŒ–å¼•æ“ - è®¡åˆ’è§£æå’ŒHookï¼ˆæ”¯æŒæ‹†åˆ†æ¶æ„ï¼‰ğŸ”„

### ğŸ¯ ç›®æ ‡
å®ç°è®¡åˆ’æ–‡æ¡£è§£æã€ä¼šè¯ç®¡ç†ã€è‡ªåŠ¨ç»§ç»­Hookï¼Œ**å®Œæ•´æ”¯æŒæ‹†åˆ†æ¶æ„**

### ğŸ“ ä»»åŠ¡æ¸…å•

#### 3.1 è®¡åˆ’è§£æå™¨ï¼ˆæ ¸å¿ƒï¼æ”¯æŒä¸¤ç§æ¶æ„ï¼‰
- [ ] å®ç° `src/core/plan-parser.js`
  - **æ£€æµ‹æ¶æ„ç±»å‹**ï¼š
    - å•æ–‡ä»¶ï¼š`xxx.md` å­˜åœ¨ä¸”ä¸æ˜¯ç›®å½•
    - æ‹†åˆ†æ¶æ„ï¼š`xxx/README.md` å­˜åœ¨
  - **å•æ–‡ä»¶è§£æ**ï¼š
    - æå–é…ç½®å¤´ï¼ˆstages, current, auto_continueç­‰ï¼‰
    - è§£ææ¯ä¸ªStageçš„ç»“æ„
    - è®¡ç®—è¿›åº¦ç™¾åˆ†æ¯”
  - **æ‹†åˆ†æ¶æ„è§£æ**ï¼š
    - è¯»å– `README.md` è·å–æ€»ä½“é…ç½®å’Œè¿›åº¦
    - ä½¿ç”¨globæ‰«æ `stages/` ç›®å½•ï¼ˆå¦‚ `01-*.md`, `02-*.md`ï¼‰
    - è¿”å›å½“å‰Stageæ–‡ä»¶è·¯å¾„
    - è®¡ç®—è¿›åº¦ï¼ˆä»README.mdçš„currentå­—æ®µï¼‰
  - **ç»Ÿä¸€æ¥å£**ï¼š
    ```javascript
    {
      type: 'single' | 'split',
      config: { stages, current, auto_continue, ... },
      currentStageFile: 'path/to/current/stage.md', // æ‹†åˆ†æ¶æ„ï¼šstages/02-xxx.md
      allStageFiles: ['stages/01-xxx.md', ...],      // ä»…æ‹†åˆ†æ¶æ„
      readmePath: 'xxx/README.md',                   // ä»…æ‹†åˆ†æ¶æ„
      progress: { completed: 2, total: 5, percentage: 40 }
    }
    ```

#### 3.2 ä¼šè¯ç®¡ç†å’Œå®‰å…¨é™åˆ¶ï¼ˆç®€åŒ–ï¼ï¼‰
- [ ] å®ç° `src/core/session-manager.js`ï¼ˆç®€åŒ–ä¸º 60 è¡Œï¼‰
  - è¯»å–/å†™å…¥ä¼šè¯çŠ¶æ€ï¼ˆ.ccautorun/sessions/xxx.jsonï¼‰
  - ä¼šè¯çŠ¶æ€æ ¼å¼ï¼š
    ```json
    {
      "taskName": "xxx",
      "count": 5,
      "status": "active",  // active / paused / failed / completed
      "currentStage": 3,
      "lastExecuted": "2025-01-06T10:30:00Z",
      "lastSessionId": "abc123",
      "lastError": null    // è®°å½•æœ€åçš„é”™è¯¯ä¿¡æ¯ï¼ˆfailed çŠ¶æ€æ—¶ï¼‰
    }
    ```
  - **åŸå­å†™å…¥**ï¼ˆå…³é”®ï¼é¿å…æ•°æ®æŸåï¼‰ï¼š
    - å…ˆå†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼š`sessions/xxx.json.tmp`
    - ç„¶å `fs.renameSync()` åŸå­æ›¿æ¢ï¼ˆrename æ˜¯åŸå­æ“ä½œï¼‰
    - æ•è·å†™å…¥é”™è¯¯ï¼Œæä¾›è¯¦ç»†æ—¥å¿—
  - æä¾›ç®€å•çš„ CRUD æ–¹æ³•
  - æ— å¤æ‚é€»è¾‘ï¼Œä¿æŒç®€å•
- [ ] å®ç° `src/core/safety-limiter.js`
  - æ£€æŸ¥æ˜¯å¦è¾¾åˆ°å®‰å…¨é™åˆ¶
  - å¯é…ç½®çš„é™åˆ¶ç­–ç•¥
  - è­¦å‘Šå’Œé˜»æ­¢é€»è¾‘

#### 3.3 è‡ªåŠ¨ç»§ç»­Hookï¼ˆå…³é”®ï¼æ”¯æŒæ‹†åˆ†æ¶æ„ + é™çº§ç­–ç•¥ï¼‰
- [ ] å®ç° `src/hooks/auto-continue.js`
  - **æ¥æ”¶Hookæ•°æ®**ï¼š
    - è¯»å–stdinçš„JSONï¼ˆsession_id, transcript_path, cwdï¼‰
    - æ·»åŠ è¶…æ—¶ä¿æŠ¤ï¼ˆ10ç§’å†…å¿…é¡»å®Œæˆï¼‰
    - æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œé¿å… Hook å´©æºƒå½±å“ Claude Code
  - **æ£€æµ‹å®Œæˆæ ‡è®°**ï¼ˆä¸‰å±‚é™çº§ç­–ç•¥ï¼‰ï¼š
    - **ä¸»ç­–ç•¥**ï¼šè§£ætranscriptæœ€å100è¡Œï¼ŒåŒ¹é… `[STAGE_COMPLETE:N]` æ ‡è®°
    - **é™çº§ç­–ç•¥1**ï¼ˆæœªæ£€æµ‹åˆ°æ ‡è®°ï¼‰ï¼š
      - æ£€æŸ¥ç‹¬ç«‹æ ‡è®°æ–‡ä»¶ï¼š`.ccautorun/sessions/<task>.stage-complete`
      - å¦‚æœå­˜åœ¨ï¼Œè¯»å– stage ç¼–å·å¹¶åˆ é™¤æ ‡è®°æ–‡ä»¶
    - **é™çº§ç­–ç•¥2**ï¼ˆä»æœªæ£€æµ‹åˆ°ï¼‰ï¼š
      - æ£€æŸ¥è®¡åˆ’æ–‡æ¡£çš„ä¿®æ”¹æ—¶é—´ï¼ˆREADME.md æˆ– xxx.mdï¼‰
      - å¦‚æœåœ¨æœ€è¿‘ 15 ç§’å†…ä¿®æ”¹ï¼Œå‡è®¾ AI å®Œæˆäº†æ›´æ–°
      - ä»æ–‡æ¡£è¯»å–æœ€æ–°çš„ current å­—æ®µ
    - **æœ€ç»ˆé™çº§**ï¼ˆä»æœªæ£€æµ‹åˆ°ï¼‰ï¼š
      - ç­‰å¾… 10 ç§’é‡æ–°æ£€æŸ¥
      - ä»æœªæ£€æµ‹åˆ°ï¼šå‘é€æ¡Œé¢é€šçŸ¥æé†’ç”¨æˆ·æ‰‹åŠ¨ç»§ç»­
      - è®°å½•è­¦å‘Šæ—¥å¿—ï¼šå»ºè®®ç”¨æˆ·åœ¨è®¡åˆ’ä¸­æ˜ç¡®è¦æ±‚ AI è¾“å‡ºæ ‡è®°æˆ–è¿è¡Œ trigger å‘½ä»¤
      - ä¸é˜»å¡ Hook è¿”å›
  - **è¯†åˆ«å½“å‰ä»»åŠ¡**ï¼š
    - ä»transcriptè§£æ@å¼•ç”¨çš„æ–‡ä»¶è·¯å¾„
    - åˆ¤æ–­æ˜¯å•æ–‡ä»¶è¿˜æ˜¯æ‹†åˆ†æ¶æ„ï¼š
      - å¦‚æœå¼•ç”¨ `xxx/stages/02-xxx.md` â†’ æ‹†åˆ†æ¶æ„ï¼Œä»»åŠ¡å=xxx
      - å¦‚æœå¼•ç”¨ `xxx.md` â†’ å•æ–‡ä»¶ï¼Œä»»åŠ¡å=xxx
  - **è¯»å–è®¡åˆ’é…ç½®**ï¼š
    - ä½¿ç”¨plan-parserè§£æï¼ˆè‡ªåŠ¨å¤„ç†ä¸¤ç§æ¶æ„ï¼‰
    - è·å–totalStages, current, safetyLimit
    - **é”™è¯¯å¤„ç†**ï¼šå¦‚æœè§£æå¤±è´¥ï¼Œè®°å½•é”™è¯¯å¹¶é€šçŸ¥ç”¨æˆ·
  - **æ£€æŸ¥ä¼šè¯çŠ¶æ€**ï¼š
    - è¯»å–ä¼šè¯çŠ¶æ€ï¼Œæ£€æŸ¥æ˜¯å¦ä¸º paused
    - å¦‚æœå·²æš‚åœï¼Œè·³è¿‡è‡ªåŠ¨ç»§ç»­ï¼Œå‘é€é€šçŸ¥
  - **æ£€æŸ¥å®‰å…¨é™åˆ¶**ï¼š
    - è¯»å–ä¼šè¯è®¡æ•°
    - åˆ¤æ–­æ˜¯å¦è¾¾åˆ°limit
    - è¾¾åˆ°é™åˆ¶ï¼šåœæ­¢è‡ªåŠ¨ç»§ç»­ï¼Œå‘é€é€šçŸ¥
  - **æ£€æµ‹é”™è¯¯çŠ¶æ€**ï¼š
    - åœ¨transcriptä¸­æœç´¢é”™è¯¯æ¨¡å¼ï¼ˆ"error", "failed", "exception" ç­‰ï¼‰
    - å¦‚æœæ£€æµ‹åˆ°é”™è¯¯ï¼Œæ£€æŸ¥ä¸¥é‡æ€§
    - ä¸¥é‡é”™è¯¯ï¼ˆç¼–è¯‘å¤±è´¥ã€æµ‹è¯•å¤±è´¥ç­‰ï¼‰ï¼š
      - å°†ä¼šè¯çŠ¶æ€è®¾ç½®ä¸º `failed`
      - è®°å½• `lastError` å­—æ®µ
      - å‘é€é”™è¯¯é€šçŸ¥
      - åœæ­¢è‡ªåŠ¨ç»§ç»­
      - æç¤ºç”¨æˆ·ä½¿ç”¨ `ccautorun retry` æˆ– `recover` å‘½ä»¤
  - **æ›´æ–°è¿›åº¦**ï¼š
    - **æ‹†åˆ†æ¶æ„**ï¼šæ›´æ–° `README.md` çš„currentå­—æ®µ
    - **å•æ–‡ä»¶**ï¼šæ›´æ–°é…ç½®å¤´çš„currentå­—æ®µ
    - **é”™è¯¯å¤„ç†**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
      - å¦‚æœæ›´æ–°å¤±è´¥ï¼ˆæ–‡ä»¶é”å®šã€æƒé™ä¸è¶³ã€æ ¼å¼é”™è¯¯ï¼‰
      - è®°å½•è¯¦ç»†é”™è¯¯æ—¥å¿—ï¼ˆåŒ…æ‹¬å †æ ˆä¿¡æ¯ï¼‰
      - å°†ä¼šè¯çŠ¶æ€è®¾ç½®ä¸º `failed`
      - è®°å½• `lastError`: "Failed to update progress in README.md"
      - å‘é€é”™è¯¯é€šçŸ¥ï¼ŒåŒ…å«å…·ä½“åŸå› å’Œä¿®å¤å»ºè®®
      - åœæ­¢è‡ªåŠ¨ç»§ç»­ï¼ˆé¿å…æ— é™å¾ªç¯ï¼‰
      - å»ºè®®ç”¨æˆ·è¿è¡Œ `ccautorun doctor` æˆ– `recover` è¯Šæ–­
  - **è‡ªåŠ¨ç»§ç»­**ï¼ˆå…³é”®ï¼æ”¯æŒè·³è¿‡æƒé™ï¼‰ï¼š
    - è¯»å–configä¸­çš„`auto_continue.skip_permissions`é…ç½®
    - æ„å»ºclaudeå‘½ä»¤ï¼š
      ```javascript
      const skipPerms = config.auto_continue?.skip_permissions ? '--dangerously-skip-permissions' : '';
      ```
    - **æ‹†åˆ†æ¶æ„**ï¼š
      ```javascript
      const nextStageFile = `xxx/stages/${String(current+1).padStart(2, '0')}-*.md`;
      const nextFile = glob.sync(nextStageFile)[0];
      exec(`claude ${skipPerms} --resume ${session_id} "@${nextFile} å¼€å§‹æ‰§è¡Œ"`);
      ```
    - **å•æ–‡ä»¶**ï¼š
      ```javascript
      exec(`claude ${skipPerms} --resume ${session_id} "@xxx.md ç»§ç»­æ‰§è¡ŒStage ${current+1}"`);
      ```
  - **å‘é€é€šçŸ¥**ï¼šæ¡Œé¢é€šçŸ¥æç¤ºè¿›åº¦

#### 3.4 é…ç½®å’Œå‘½ä»¤
- [ ] åˆ›å»º `.claude/hooks.yaml` æ¨¡æ¿
  ```yaml
  hooks:
    - event: Stop
      command: node src/hooks/auto-continue.js
      description: Auto-continue to next stage
      enabled: false  # é»˜è®¤å…³é—­ï¼Œç”¨æˆ·æ‰‹åŠ¨å¯ç”¨
  ```
- [ ] å®ç° `ccautorun trigger <task-name>` å‘½ä»¤ï¼ˆæ‰‹åŠ¨è§¦å‘ Hookï¼‰
  - æ‰‹åŠ¨è§¦å‘ä¸‹ä¸€ä¸ª Stage çš„è‡ªåŠ¨ç»§ç»­
  - ç”¨äº Hook å¤±è´¥æˆ–æ£€æµ‹ä¸åˆ°æ ‡è®°æ—¶çš„é™çº§æ–¹æ¡ˆ
  - è¯»å–æœ€åçš„ session_idï¼ˆä»ä¼šè¯çŠ¶æ€ï¼‰
  - æ‰§è¡Œä¸ Hook ç›¸åŒçš„é€»è¾‘ï¼ˆæ›´æ–°è¿›åº¦ + claude --resumeï¼‰
  - ä¸ä¾èµ– transcript è§£æ
- [ ] å®ç° `ccautorun reset [task-name]` å‘½ä»¤
  - é‡ç½®æŒ‡å®šä»»åŠ¡çš„ä¼šè¯è®¡æ•°
  - æ”¯æŒä¸¤ç§æ¶æ„
  - å¯é€‰ï¼šé‡ç½®åˆ°æŒ‡å®š Stageï¼ˆ`--stage N`ï¼‰

### âœ… å®Œæˆæ ‡å‡†
- [ ] plan-parserå¯ä»¥æ­£ç¡®è§£æ**ä¸¤ç§æ¶æ„**çš„è®¡åˆ’æ–‡æ¡£
- [ ] plan-parserå¯ä»¥å‡†ç¡®è¯†åˆ«æ¶æ„ç±»å‹
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šplan-parserå¯ä»¥æ‰«æå¹¶è¿”å›æ‰€æœ‰stageæ–‡ä»¶
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šplan-parserå¼ºåˆ¶ç²¾ç¡®åŒ¹é…æ–‡ä»¶åï¼ˆ`01-name.md`ï¼‰ï¼Œé¿å… backup æ–‡ä»¶
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šplan-parserå¯ä»¥è¿”å›ä¸‹ä¸€ä¸ªstageæ–‡ä»¶è·¯å¾„
- [ ] **session-manager ä½¿ç”¨åŸå­å†™å…¥**ï¼šwrite to tmp + rename
- [ ] session-manager ç®€åŒ–ä¸º 60 è¡Œå·¦å³ï¼Œåªæä¾› CRUD åŠŸèƒ½
- [ ] **ä¼šè¯çŠ¶æ€æ”¯æŒ failed**ï¼šåŒ…å« lastError å­—æ®µ
- [ ] safety-limiterå¯ä»¥æ­£ç¡®åˆ¤æ–­é™åˆ¶
- [ ] Hookå¯ä»¥æ¥æ”¶stdinå¹¶è§£æï¼Œæœ‰è¶…æ—¶ä¿æŠ¤å’Œå¼‚å¸¸æ•è·
- [ ] Hookå¯ä»¥è¯†åˆ«è®¡åˆ’æ–‡ä»¶è·¯å¾„ï¼ˆå•æ–‡ä»¶æˆ–stages/xx-xxx.mdï¼‰
- [ ] Hookå¯ä»¥æ£€æµ‹é˜¶æ®µå®Œæˆæ ‡è®°
- [ ] **Hookä¸‰å±‚é™çº§ç­–ç•¥æœ‰æ•ˆ**ï¼š
  - ä¸»ç­–ç•¥ï¼štranscriptæ ‡è®°
  - é™çº§1ï¼šç‹¬ç«‹æ ‡è®°æ–‡ä»¶
  - é™çº§2ï¼šæ–‡ä»¶ä¿®æ”¹æ—¶é—´
  - æœ€ç»ˆï¼šé€šçŸ¥ç”¨æˆ·
- [ ] **Hookå¯ä»¥æ£€æµ‹é”™è¯¯å¹¶è®¾ç½® failed çŠ¶æ€**
- [ ] Hookå¯ä»¥æ£€æŸ¥ä¼šè¯çŠ¶æ€ï¼ˆpaused/failed æ—¶ä¸ç»§ç»­ï¼‰
- [ ] **Hooké”™è¯¯å¤„ç†å®Œå–„**ï¼šæ›´æ–°è¿›åº¦å¤±è´¥æ—¶è®°å½•è¯¦ç»†æ—¥å¿—ã€è®¾ç½® failedã€å‘é€é€šçŸ¥ã€åœæ­¢ç»§ç»­
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šHookå¯ä»¥æ­£ç¡®æ›´æ–°README.mdçš„è¿›åº¦
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šHookå¯ä»¥æ‰¾åˆ°ä¸‹ä¸€ä¸ªstageæ–‡ä»¶å¹¶è‡ªåŠ¨ç»§ç»­
- [ ] **å•æ–‡ä»¶**ï¼šHookå¯ä»¥æ­£ç¡®æ›´æ–°é…ç½®å¤´å¹¶è‡ªåŠ¨ç»§ç»­
- [ ] Hookå¯ä»¥æ‰§è¡Œclaude --resumeå‘½ä»¤
- [ ] trigger å‘½ä»¤å¯ä»¥æ‰‹åŠ¨è§¦å‘ä¸‹ä¸€ä¸ª Stage
- [ ] resetå‘½ä»¤å¯ä»¥é‡ç½®ä¼šè¯ï¼Œæ”¯æŒ --stage N

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `src/core/plan-parser.js` (400è¡Œï¼Œå¢åŠ æ‹†åˆ†æ¶æ„æ”¯æŒå’Œç²¾ç¡®æ–‡ä»¶ååŒ¹é…ï¼‰
- [ ] `src/core/session-manager.js` (80è¡Œï¼Œå¢åŠ åŸå­å†™å…¥å’Œ failed çŠ¶æ€ï¼‰
- [ ] `src/core/safety-limiter.js` (80è¡Œ)
- [ ] `src/hooks/auto-continue.js` (650è¡Œï¼Œå¢åŠ ä¸‰å±‚é™çº§ç­–ç•¥ã€é”™è¯¯æ£€æµ‹å’Œ failed çŠ¶æ€å¤„ç†ï¼‰
- [ ] `src/commands/reset.js` (80è¡Œï¼Œå¢åŠ  --stage æ”¯æŒï¼‰
- [ ] `src/commands/trigger.js` (100è¡Œï¼Œæ–°å¢ï¼‰
- [ ] `.claude/hooks.yaml` (æ¨¡æ¿)

### âš ï¸ æ³¨æ„äº‹é¡¹
- **æ‹†åˆ†æ¶æ„è·¯å¾„è§£ææ˜¯å…³é”®**ï¼šæ­£ç¡®è¯†åˆ« `xxx/stages/02-api.md` ä¸­çš„ä»»åŠ¡å"xxx"
- **åŸå­å†™å…¥è‡³å…³é‡è¦**ï¼š
  - ä½¿ç”¨ `fs.writeFileSync(tmp) + fs.renameSync()` ä¿è¯åŸå­æ€§
  - ä¸ä½¿ç”¨ SQLiteï¼Œå¤æ‚åº¦å¤ªé«˜ä¸”å…¼å®¹æ€§å·®
- **failed çŠ¶æ€æ˜¯é”™è¯¯æ¢å¤çš„å…³é”®**ï¼š
  - Hook æ£€æµ‹åˆ°é”™è¯¯æ—¶è®¾ç½® failed
  - retry/recover å‘½ä»¤ä» failed æ¢å¤
  - è®°å½•è¯¦ç»†çš„ lastError ä¿¡æ¯
- **Hook å¯é æ€§è‡³å…³é‡è¦**ï¼š
  - å¿…é¡»æœ‰è¶…æ—¶ä¿æŠ¤ï¼ˆ10ç§’ï¼‰
  - å¿…é¡»æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œä¸èƒ½å´©æºƒ
  - **ä¸‰å±‚é™çº§ç­–ç•¥**ï¼š
    1. transcript æ ‡è®°ï¼ˆæœ€å¯é ï¼‰
    2. ç‹¬ç«‹æ ‡è®°æ–‡ä»¶ï¼ˆå¤‡é€‰ï¼‰
    3. æ–‡ä»¶ä¿®æ”¹æ—¶é—´ï¼ˆå…œåº•ï¼‰
    4. é€šçŸ¥ç”¨æˆ·ï¼ˆæœ€ç»ˆï¼‰
  - é”™è¯¯é€šçŸ¥å¿…é¡»åŒ…å«ä¿®å¤å»ºè®®å’Œ `ccautorun doctor` æˆ– `recover` æç¤º
- Hookéœ€è¦èƒ½å¤„ç†stdinçš„JSONæ•°æ®
- transcriptæ–‡ä»¶å¯èƒ½å¾ˆå¤§ï¼Œåªè¯»å–æœ€å100è¡Œ
- æ­£åˆ™è¡¨è¾¾å¼è¦ç²¾ç¡®åŒ¹é… `[STAGE_COMPLETE:N]`
- claudeå‘½ä»¤æ‰§è¡Œè¦å¼‚æ­¥ï¼Œä¸é˜»å¡Hookè¿”å›
- **ç‹¬ç«‹æ ‡è®°æ–‡ä»¶æœºåˆ¶**ï¼šç®€å•ä¸”å¯é ï¼ŒAI å¯ä»¥åœ¨æ— æ³•è¾“å‡ºæ ‡è®°æ—¶åˆ›å»ºæ–‡ä»¶
- **skip_permissionsè‡³å…³é‡è¦**ï¼š
  - é»˜è®¤ä½¿ç”¨`--dangerously-skip-permissions`è·³è¿‡æƒé™ç¡®è®¤
  - å¦åˆ™è‡ªåŠ¨ç»§ç»­ä¼šè¢«æƒé™å¼¹çª—ä¸­æ–­ï¼Œå¤±å»è‡ªåŠ¨åŒ–æ„ä¹‰
  - ç¡®ä¿ä»config.yamlæ­£ç¡®è¯»å–æ­¤é…ç½®
  - å¦‚æœconfigä¸­è®¾ç½®ä¸ºfalseï¼Œéœ€è®°å½•è­¦å‘Šï¼ˆè‡ªåŠ¨åŒ–å°†å¤±è´¥ï¼‰
- **Stage æ–‡ä»¶åæ ¼å¼å¼ºåˆ¶ç²¾ç¡®åŒ¹é…**ï¼ˆé‡è¦ï¼ï¼‰ï¼š
  - åªåŒ¹é… `01-*.md`, `02-*.md` ç­‰æ ¼å¼
  - å¦‚æœåŒ¹é…åˆ°å¤šä¸ªæ–‡ä»¶ï¼ŒæŠ¥é”™è€Œä¸æ˜¯çŒœæµ‹
  - å»ºè®®ç”¨æˆ·æ£€æŸ¥å¹¶åˆ é™¤ backup/old/draft æ–‡ä»¶
  - ä¸åšæ™ºèƒ½é€‰æ‹©ï¼Œé¿å…è¯¯åˆ¤
- **æ›´æ–°README.mdæ—¶ä¿æŒæ ¼å¼**ï¼šåªä¿®æ”¹currentå­—æ®µï¼Œä¸ç ´åå…¶ä»–å†…å®¹
- **READMEæ›´æ–°å¤±è´¥å¤„ç†**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - è®°å½•è¯¦ç»†é”™è¯¯ï¼ˆæ–‡ä»¶é”å®šã€æƒé™ã€æ ¼å¼é”™è¯¯ç­‰ï¼‰
  - å‘é€é”™è¯¯é€šçŸ¥ï¼ŒåŒ…å«å…·ä½“åŸå› 
  - åœæ­¢è‡ªåŠ¨ç»§ç»­ï¼ˆé¿å…æ— é™å¾ªç¯ï¼‰
  - æç¤ºç”¨æˆ·è¿è¡Œ `ccautorun doctor` è¯Šæ–­
  - æç¤ºç”¨æˆ·æ£€æŸ¥ README.md æ ¼å¼
- **session-manager ç®€åŒ–**ï¼šåªåšç®€å•çš„ CRUDï¼Œæ— å¤æ‚é€»è¾‘
- **é”™è¯¯å¤„ç†**ï¼šå¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªstageæ–‡ä»¶ï¼ŒæŠ¥é”™è€Œä¸æ˜¯crash
- **Windows å…¼å®¹æ€§**ï¼šä½¿ç”¨ Node.js fs APIï¼Œä¸ä¾èµ– shell å‘½ä»¤

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# æµ‹è¯•plan-parser
node -e "import('./src/core/plan-parser.js').then(m => console.log(m.parsePlan('test.md')))"

# æµ‹è¯• session-managerï¼ˆéªŒè¯ç®€åŒ–ååŠŸèƒ½ï¼‰
node -e "import('./src/core/session-manager.js').then(m => {
  m.create('test', {stage: 1});
  console.log(m.read('test'));
})"
# åº”è¯¥ç®€å•æ˜äº†ï¼Œåªæœ‰åŸºæœ¬çš„ CRUD

# æµ‹è¯• Hookï¼ˆæ¨¡æ‹Ÿæ­£å¸¸æµç¨‹ï¼‰
echo '{"session_id":"test","transcript_path":"/tmp/test.txt","cwd":"/tmp"}' | node src/hooks/auto-continue.js
# åº”åœ¨ 10 ç§’å†…å®Œæˆï¼Œä¸å´©æºƒ

# æµ‹è¯• Hookï¼ˆæ¨¡æ‹Ÿæ— æ ‡è®°åœºæ™¯ï¼‰
# åˆ›å»ºä¸€ä¸ªæ²¡æœ‰ [STAGE_COMPLETE] çš„ transcript
echo "some output without marker" > /tmp/test-no-marker.txt
echo '{"session_id":"test","transcript_path":"/tmp/test-no-marker.txt","cwd":"/tmp"}' | node src/hooks/auto-continue.js
# åº”å‘é€é€šçŸ¥ï¼Œä¸å´©æºƒ

# æµ‹è¯• triggerï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰
ccautorun trigger test-task
# åº”æ‰‹åŠ¨è§¦å‘ä¸‹ä¸€ä¸ª Stage

# æµ‹è¯• reset
ccautorun reset test-task
ccautorun reset test-task --stage 2
```

---

## Stage 4: AIè®¡åˆ’ç”Ÿæˆç³»ç»Ÿ - Slashå‘½ä»¤æ ¸å¿ƒï¼ˆæ‹†åˆ†æ¶æ„ï¼‰ğŸ”„

### ğŸ¯ ç›®æ ‡
å®ç° `/plan` Slashå‘½ä»¤ï¼Œç”Ÿæˆ**æ‹†åˆ†æ¶æ„**çš„æ‰§è¡Œè®¡åˆ’ï¼Œè¿™æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½

### ğŸ“ ä»»åŠ¡æ¸…å•

#### 4.1 æ ¸å¿ƒ Slash å‘½ä»¤
- [ ] åˆ›å»º `.claude/commands/plan.md`ï¼ˆæ”¯æŒæ¶æ„é€‰æ‹©å‚æ•°å’Œæ¨¡æ¿ï¼‰
  - **Phase 0: å‚æ•°è§£æ**ï¼ˆç›´æ¥åœ¨ slash command ä¸­å¤„ç†ï¼‰
    - ç›´æ¥è§£æç”¨æˆ·è¾“å…¥ä¸­çš„æ¶æ„å‚æ•°ï¼š
      - `--architecture auto|split|single`
      - `--force-split` (ç­‰åŒäº --architecture split)
      - `--force-single` (ç­‰åŒäº --architecture single)
      - `--template <name>` (ä½¿ç”¨æ¨¡æ¿)
    - å¦‚æœæœªæŒ‡å®šï¼Œä»config.yamlè¯»å–default_architectureï¼ˆä½¿ç”¨ Read å·¥å…·ï¼‰
    - è®°å½•æ¶æ„é€‰æ‹©æ¨¡å¼ï¼ˆauto/split/singleï¼‰
    - æä¾›æ˜ç¡®æŒ‡ä»¤ç»™ AIï¼Œé¿å…è¯¯åˆ¤
  - **Phase 1: éœ€æ±‚æ¾„æ¸…**ï¼ˆæé—®ç”¨æˆ·ï¼‰
    - ä»»åŠ¡èƒŒæ™¯å’Œç›®æ ‡
    - æŠ€æœ¯æ ˆå’Œç¯å¢ƒ
    - é¢„æœŸäº¤ä»˜ç‰©
    - æ—¶é—´é¢„æœŸ
  - **Phase 2: è®¡åˆ’ç»“æ„è®¾è®¡ + æ¶æ„åˆ¤æ–­**ï¼ˆç¡®è®¤é˜¶æ®µåˆ’åˆ†ï¼‰
    - ç”Ÿæˆé«˜å±‚æ¬¡Stageæ¦‚è¦ï¼ˆ3-8ä¸ªStageï¼‰
    - æ¯ä¸ªStageä¸€å¥è¯æè¿°å’Œé¢„è®¡è¡Œæ•°
    - **æ¶æ„åˆ¤æ–­**ï¼ˆå¦‚æœPhase 0æ˜¯autoæ¨¡å¼ï¼‰ï¼š
      - è®¡ç®—æ€»Stageæ•°å’Œé¢„è®¡æ€»è¡Œæ•°
      - åº”ç”¨åˆ¤æ–­è§„åˆ™ï¼š
        - **å•æ–‡ä»¶é€‚åˆ**ï¼šStageæ•°â‰¤3 ä¸” æ€»è¡Œæ•°<2500 ä¸” ä»»åŠ¡ç®€å•
        - **æ‹†åˆ†æ¶æ„é€‚åˆ**ï¼šStageæ•°>3 æˆ– æ€»è¡Œæ•°â‰¥2500 æˆ– ä»»åŠ¡å¤æ‚
      - å‘ç”¨æˆ·è¯´æ˜æ¨èæ¶æ„å’Œç†ç”±
      - è¯¢é—®ç”¨æˆ·ï¼š"1) æ¥å—æ¨è 2) å¼ºåˆ¶æ‹†åˆ† 3) å¼ºåˆ¶å•æ–‡ä»¶"
    - **å¦‚æœPhase 0å·²å¼ºåˆ¶æŒ‡å®šæ¶æ„**ï¼šç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€è¯¢é—®
    - ç”¨æˆ·ç¡®è®¤é€‰é¡¹ï¼š
      - âœ… ç¡®è®¤å¹¶ç»§ç»­ç”Ÿæˆè¯¦ç»†å†…å®¹
      - â™»ï¸  ä¿®æ”¹Stageåˆ’åˆ†ï¼ˆè¿”å›Phase 2é‡æ–°è®¾è®¡ï¼‰
      - âŒ å–æ¶ˆè®¡åˆ’ç”Ÿæˆ
  - **Phase 3: æ¶æ„ç”Ÿæˆ**ï¼ˆå…³é”®ï¼æ ¹æ®Phase 2å†³å®šçš„æ¶æ„ï¼‰
    - **å¦‚æœæ˜¯æ‹†åˆ†æ¶æ„**ï¼š
      - ç”Ÿæˆ `README.md`ï¼ˆ200-300è¡Œï¼‰ï¼š
        - AUTO-RUN-CONFIGé…ç½®å¤´ï¼ˆarchitecture: splitï¼‰
        - ä»»åŠ¡æ¦‚è§ˆ
        - èƒŒæ™¯å’Œç›®æ ‡
        - æ‰§è¡Œè§„åˆ™
        - **Stageç´¢å¼•**ï¼ˆæ¯ä¸ªStageä¸€è¡Œæ¦‚è¦+é“¾æ¥åˆ°è¯¦ç»†æ–‡ä»¶ï¼‰
      - é€ä¸ªç”Ÿæˆ `stages/0X-stage-name.md`ï¼ˆ600-1000è¡Œ/ä¸ªï¼‰ï¼š
        - ç›®æ ‡
        - ä»»åŠ¡æ¸…å•ï¼ˆè¯¦ç»†çš„å­ä»»åŠ¡ï¼‰
        - å®Œæˆæ ‡å‡†
        - é¢„æœŸè¾“å‡º
        - æ³¨æ„äº‹é¡¹
        - éªŒè¯å‘½ä»¤
    - **å¦‚æœæ˜¯å•æ–‡ä»¶æ¶æ„**ï¼š
      - ç”Ÿæˆå•ä¸ª `task-name.md`ï¼ˆ1500-3000è¡Œï¼‰ï¼š
        - AUTO-RUN-CONFIGé…ç½®å¤´ï¼ˆarchitecture: singleï¼‰
        - ä»»åŠ¡æ¦‚è§ˆ
        - èƒŒæ™¯å’Œç›®æ ‡
        - æ‰§è¡Œè§„åˆ™
        - æ‰€æœ‰Stageçš„è¯¦ç»†å†…å®¹ï¼ˆåœ¨åŒä¸€æ–‡ä»¶å†…ï¼‰
        - æ¯ä¸ªStageåŒ…å«ï¼šç›®æ ‡ã€ä»»åŠ¡æ¸…å•ã€å®Œæˆæ ‡å‡†ç­‰
  - **Phase 4: è‡ªæˆ‘Review**ï¼ˆæ£€æŸ¥ç–æ¼å’Œè¿‡åº¦è®¾è®¡ï¼‰
    - æ£€æŸ¥Stageåˆ’åˆ†æ˜¯å¦åˆç†
    - æ£€æŸ¥ä»»åŠ¡æ˜¯å¦æœ‰é—æ¼
    - æ£€æŸ¥æ˜¯å¦è¿‡åº¦è®¾è®¡
    - æ£€æŸ¥Tokenæ•ˆç‡ï¼ˆå•ä¸ªStageæ˜¯å¦>1500 tokensï¼‰
  - **Phase 5: ä¿å­˜æ–‡ä»¶**ï¼ˆæ ¹æ®æ¶æ„ç±»å‹ï¼‰
    - **æ–‡ä»¶å†™å…¥å®ç°**ï¼š
      - æç¤ºè¯ä¸­æ˜ç¡®æŒ‡ç¤ºAIä½¿ç”¨Writeå·¥å…·
      - **æ‹†åˆ†æ¶æ„**ï¼š
        - åˆ›å»ºç›®å½•ï¼š`mkdir -p .ccautorun/plans/task-name/stages`
        - ä½¿ç”¨Writeå·¥å…·å†™å…¥README.md
        - ä¾æ¬¡å†™å…¥å„stageæ–‡ä»¶åˆ°stages/ç›®å½•
      - **å•æ–‡ä»¶æ¶æ„**ï¼š
        - ç¡®ä¿ç›®å½•å­˜åœ¨ï¼š`mkdir -p .ccautorun/plans`
        - ä½¿ç”¨Writeå·¥å…·å†™å…¥å•ä¸ª `task-name.md`
      - åŒ…å«é”™è¯¯å¤„ç†ï¼ˆç›®å½•å·²å­˜åœ¨ã€æƒé™ä¸è¶³ã€ç£ç›˜ç©ºé—´ç­‰ï¼‰
      - æ¯ä¸ªæ–‡ä»¶å†™å…¥åç¡®è®¤æˆåŠŸ
  - **Phase 6: éªŒè¯è®¡åˆ’**ï¼ˆå…³é”®ï¼ç¡®ä¿è®¡åˆ’è´¨é‡ï¼‰
    - æç¤ºè¯æŒ‡ç¤º AI è°ƒç”¨ `ccautorun validate <task-name>` å‘½ä»¤
    - éªŒè¯è®¡åˆ’æ–‡æ¡£æ ¼å¼ï¼š
      - é…ç½®å¤´æ˜¯å¦å®Œæ•´
      - Stage æ–‡ä»¶å‘½åæ˜¯å¦è§„èŒƒ
      - æ–‡ä»¶å†…å®¹ç»“æ„æ˜¯å¦å®Œæ•´
    - Token æ•ˆç‡æ£€æŸ¥ï¼š
      - æ‹†åˆ†æ¶æ„ï¼šå•ä¸ª Stage < 1500 tokens
      - å•æ–‡ä»¶ï¼šæ€»è®¡ < 5000 tokens
    - å¦‚æœéªŒè¯å¤±è´¥ï¼š
      - æ˜¾ç¤ºå…·ä½“é—®é¢˜å’Œå»ºè®®
      - è¯¢é—®ç”¨æˆ·æ˜¯å¦ä¿®å¤ï¼ˆè¿”å› Phase 3 æˆ– 4 é‡æ–°ç”Ÿæˆï¼‰
    - å¦‚æœéªŒè¯é€šè¿‡ï¼š
      - æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
      - æç¤ºç”¨æˆ·å¯ä»¥å¼€å§‹æ‰§è¡Œï¼š`claude "@<task>/<stage-01>.md" å¼€å§‹æ‰§è¡Œ`
- [ ] è®¾è®¡æ‹†åˆ†æ¶æ„æ¨¡æ¿
  - **README.mdæ¨¡æ¿**ï¼ˆè°ƒåº¦æ–‡æ¡£ï¼‰
  - **Stageè¯¦ç»†æ–‡æ¡£æ¨¡æ¿**ï¼ˆè¯¦ç»†è®¾è®¡ï¼‰
  - ä¸¤è€…æ ¼å¼è¦ç»Ÿä¸€ä¸”æ¸…æ™°
- [ ] ä¼˜åŒ–æç¤ºè¯ï¼Œç¡®ä¿AIï¼š
  - å¿…é¡»è¯¢é—®ä¸ç¡®å®šçš„ç‚¹ï¼ˆä¸èƒ½å‡è®¾ï¼‰
  - å¿…é¡»è®©ç”¨æˆ·ç¡®è®¤é˜¶æ®µç»“æ„ï¼ˆä¸èƒ½ç›´æ¥ç”Ÿæˆï¼‰
  - å¿…é¡»åšè‡ªæˆ‘Reviewï¼ˆä¸èƒ½æ•·è¡ï¼‰
  - å¿…é¡»æŒ‡å‡ºå‘ç°çš„é—®é¢˜ï¼ˆè¯šå®åé¦ˆï¼‰
  - **å¿…é¡»ç”Ÿæˆæ‹†åˆ†æ¶æ„**ï¼ˆä¸æ˜¯å•æ–‡ä»¶ï¼‰
- [ ] æ”¯æŒå¤šç§è¾“å…¥æ–¹å¼ï¼š
  - çº¯æ–‡æœ¬æè¿°ï¼š`/plan æˆ‘è¦é‡æ„authæ¨¡å—`
  - @æ–‡æ¡£å¼•ç”¨ï¼š`/plan @docs/prd.md æ ¹æ®è¿™ä¸ªPRDç”Ÿæˆè®¡åˆ’`
  - ä½¿ç”¨æ¨¡æ¿ï¼š`/plan --template refactor é‡æ„authæ¨¡å—`
  - æ··åˆæ–¹å¼
- [ ] å®ç°æ™ºèƒ½ä»»åŠ¡åç”Ÿæˆ
  - ä»ä»»åŠ¡æè¿°æå–å…³é”®è¯
  - ç”Ÿæˆkebab-caseç›®å½•å
  - æ£€æŸ¥ç›®å½•æ˜¯å¦å·²å­˜åœ¨

#### 4.2 æ¨¡æ¿ç³»ç»Ÿï¼ˆSlash Command å®ç°ï¼‰
- [ ] åˆ›å»º `.claude/commands/plan-with-template.md`ï¼ˆæˆ–é›†æˆåˆ° plan.mdï¼‰
  - åˆ—å‡ºå¯ç”¨æ¨¡æ¿
  - åŠ è½½æŒ‡å®šæ¨¡æ¿
  - åŸºäºæ¨¡æ¿ç”Ÿæˆè®¡åˆ’ï¼ˆé¢„å¡«å……ç»“æ„ï¼‰
- [ ] åˆ›å»ºæ¨¡æ¿ç›®å½• `templates/`
  - `templates/refactor.yaml` - é‡æ„ä»»åŠ¡æ¨¡æ¿
  - `templates/feature.yaml` - æ–°åŠŸèƒ½å¼€å‘æ¨¡æ¿
  - `templates/bugfix.yaml` - Bugä¿®å¤æ¨¡æ¿
  - `templates/docs.yaml` - æ–‡æ¡£ç”Ÿæˆæ¨¡æ¿
- [ ] æ¨¡æ¿æ ¼å¼ï¼š
  ```yaml
  name: refactor
  description: Refactor existing code
  architecture: split  # æ¨èæ¶æ„
  stages:
    - name: Analysis
      description: Analyze current code and identify issues
      estimated_lines: 800
    - name: Design
      description: Design refactoring approach
      estimated_lines: 900
    - name: Implementation
      description: Implement refactoring changes
      estimated_lines: 1000
  prompts:
    - "What modules need refactoring?"
    - "What are the main pain points?"
    - "What's the desired architecture?"
  ```
- [ ] å®ç°æ¨¡æ¿åº”ç”¨é€»è¾‘ï¼ˆåœ¨ slash command ä¸­ï¼‰
  - è¯»å–æ¨¡æ¿æ–‡ä»¶
  - æ ¹æ®æ¨¡æ¿é¢„å¡«å…… Stage ç»“æ„
  - AI åŸºäºæ¨¡æ¿è¿›è¡Œç»†åŒ–ï¼ˆä¸æ˜¯ä»é›¶å¼€å§‹ï¼‰
  - ä»ç„¶ç»è¿‡ç¡®è®¤å’Œ Review ç¯èŠ‚

### âœ… å®Œæˆæ ‡å‡†
- [ ] `/plan` å‘½ä»¤å¯ä»¥æ­£å¸¸è°ƒç”¨ï¼Œæ”¯æŒæ¶æ„å‚æ•°å’Œæ¨¡æ¿
- [ ] **Phase 0å‚æ•°è§£ææ­£ç¡®**ï¼šç›´æ¥åœ¨ slash command ä¸­è§£æ
- [ ] å¦‚æœæœªæŒ‡å®šå‚æ•°ï¼Œä»config.yamlè¯»å–default_architectureï¼ˆä½¿ç”¨ Read å·¥å…·ï¼‰
- [ ] AIä¼šä¸»åŠ¨æé—®æ¾„æ¸…éœ€æ±‚ï¼ˆè‡³å°‘3ä¸ªé—®é¢˜ï¼‰
- [ ] **Phase 2æ¶æ„åˆ¤æ–­é€»è¾‘æ­£ç¡®**ï¼ˆautoæ¨¡å¼ï¼‰ï¼š
  - èƒ½æ ¹æ®Stageæ•°å’Œè¡Œæ•°æ¨èæ¶æ„
  - å‘ç”¨æˆ·è¯´æ˜æ¨èç†ç”±
  - è¯¢é—®ç”¨æˆ·ç¡®è®¤æˆ–ä¿®æ”¹
- [ ] **å¼ºåˆ¶æ¨¡å¼ç›´æ¥ä½¿ç”¨æŒ‡å®šæ¶æ„**ï¼Œæ— éœ€è¯¢é—®
- [ ] **æ¨¡æ¿ç³»ç»Ÿå·¥ä½œæ­£å¸¸**ï¼š
  - `/plan --template refactor` å¯ä»¥åŠ è½½æ¨¡æ¿
  - AI åŸºäºæ¨¡æ¿é¢„å¡«å…… Stage ç»“æ„
  - ä»ç»è¿‡ç¡®è®¤å’Œ Review
- [ ] AIä¼šè®©ç”¨æˆ·ç¡®è®¤Stageç»“æ„åå†ç”Ÿæˆè¯¦ç»†å†…å®¹
- [ ] AIä¼šåšè‡ªæˆ‘Reviewå¹¶æŒ‡å‡ºè‡³å°‘1ä¸ªæ½œåœ¨é—®é¢˜
- [ ] **æ‹†åˆ†æ¶æ„ç”Ÿæˆæ­£ç¡®**ï¼š`task-name/README.md` + `stages/0X-*.md`
- [ ] **å•æ–‡ä»¶æ¶æ„ç”Ÿæˆæ­£ç¡®**ï¼š`task-name.md`ï¼ˆåŒ…å«æ‰€æœ‰Stageï¼‰
- [ ] é…ç½®å¤´åŒ…å«æ­£ç¡®çš„architectureå­—æ®µï¼ˆsplit/singleï¼‰
- [ ] æ¯ä¸ªæ–‡ä»¶æ ¼å¼å®Œå…¨ç¬¦åˆæ¨¡æ¿
- [ ] Stageæ–‡ä»¶å‘½åè§„èŒƒï¼š`01-stage-name.md`, `02-next-stage.md`
- [ ] æ”¯æŒ@æ–‡æ¡£å¼•ç”¨
- [ ] ä»»åŠ¡åè‡ªåŠ¨ç”Ÿæˆä¸”åˆç†
- [ ] **Phase 6 éªŒè¯è®¡åˆ’**ï¼š
  - AI ä¼šè°ƒç”¨ `ccautorun validate` å‘½ä»¤
  - éªŒè¯é…ç½®å¤´ã€æ–‡ä»¶å‘½åã€å†…å®¹ç»“æ„
  - éªŒè¯ Token æ•ˆç‡
  - éªŒè¯å¤±è´¥æ—¶æç¤ºç”¨æˆ·ä¿®å¤
  - éªŒè¯é€šè¿‡åæç¤ºç”¨æˆ·å¦‚ä½•å¼€å§‹æ‰§è¡Œ

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `.claude/commands/plan.md` (1400-1600è¡Œï¼Œç›´æ¥å¤„ç†å‚æ•°å’Œæ¨¡æ¿ï¼Œå¢åŠ  Phase 6 éªŒè¯ï¼‰
- [ ] `templates/plan-templates/` ç›®å½•ï¼š
  - `refactor.yaml` - é‡æ„æ¨¡æ¿
  - `feature.yaml` - æ–°åŠŸèƒ½æ¨¡æ¿
  - `bugfix.yaml` - Bugä¿®å¤æ¨¡æ¿
  - `docs.yaml` - æ–‡æ¡£ç”Ÿæˆæ¨¡æ¿
- [ ] `templates/split-plan/README.md` (æ‹†åˆ†æ¶æ„READMEæ¨¡æ¿)
- [ ] `templates/split-plan/stages/01-example.md` (æ‹†åˆ†æ¶æ„Stageæ¨¡æ¿)
- [ ] `templates/single-plan.md` (å•æ–‡ä»¶æ¶æ„æ¨¡æ¿)
- [ ] `examples/` ç›®å½•ä¸‹3ä¸ªç¤ºä¾‹ï¼ˆ2æ‹†åˆ†+1å•æ–‡ä»¶ï¼‰
  - `refactor-auth/` - è®¤è¯æ¨¡å—é‡æ„ï¼ˆæ‹†åˆ†æ¶æ„ï¼Œ5 stagesï¼‰
  - `api-documentation/` - APIæ–‡æ¡£ç”Ÿæˆï¼ˆæ‹†åˆ†æ¶æ„ï¼Œ3 stagesï¼‰
  - `config-update.md` - é…ç½®æ–‡ä»¶æ›´æ–°ï¼ˆå•æ–‡ä»¶æ¶æ„ï¼Œ2 stagesï¼‰
  - åç»­æ ¹æ®ç”¨æˆ·åé¦ˆå†æ·»åŠ æ›´å¤šç¤ºä¾‹ï¼ˆv2.0.1+ï¼‰

### âš ï¸ æ³¨æ„äº‹é¡¹
- **å‚æ•°è§£æç›´æ¥åœ¨ slash command ä¸­**ï¼š
  - ä½¿ç”¨ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…è§£æå‚æ•°
  - æä¾›ç»™ AI æ˜ç¡®çš„å‚æ•°å€¼ï¼Œé¿å… AI è¯¯åˆ¤æˆ–å¿½ç•¥å‚æ•°
  - å¦‚æœè§£æå¤±è´¥ï¼Œç»™å‡ºæ¸…æ™°çš„é”™è¯¯æç¤º
- **æ¶æ„é€‰æ‹©å‚æ•°**ï¼š
  - Phase 0 ç›´æ¥è§£æç”¨æˆ·è¾“å…¥
  - ä½¿ç”¨ Read å·¥å…·è¯»å– config.yaml è·å–é»˜è®¤æ¶æ„
  - autoæ¨¡å¼çš„åˆ¤æ–­é€»è¾‘è¦æ¸…æ™°ï¼Œå‘ç”¨æˆ·è§£é‡Šæ¨èç†ç”±
- **Phase 6 éªŒè¯è‡³å…³é‡è¦**ï¼š
  - å¿…é¡»è°ƒç”¨ `ccautorun validate` å‘½ä»¤
  - éªŒè¯å¤±è´¥æ—¶ç»™å‡ºå…·ä½“å»ºè®®
  - æç¤ºç”¨æˆ·å¦‚ä½•å¼€å§‹æ‰§è¡Œ
- **æ¨¡æ¿ç³»ç»Ÿè®¾è®¡**ï¼š
  - æ¨¡æ¿æ˜¯è¾…åŠ©ï¼Œä¸æ˜¯å®Œå…¨æ›¿ä»£ AI ç”Ÿæˆ
  - AI ä»éœ€è¦è¯¢é—®ã€ç¡®è®¤ã€Review
  - æ¨¡æ¿æ ¼å¼è¦ç®€å•ï¼Œæ˜“äºç”¨æˆ·è‡ªå®šä¹‰
- **åŒæ¶æ„æ”¯æŒ**ï¼šæç¤ºè¯å¿…é¡»åŒ…å«ä¸¤å¥—ç”Ÿæˆæ¨¡æ¿ï¼ˆæ‹†åˆ†å’Œå•æ–‡ä»¶ï¼‰
- æç¤ºè¯è®¾è®¡æ˜¯æˆè´¥å…³é”®ï¼Œéœ€è¦åå¤æµ‹è¯•ä¼˜åŒ–
- AIçš„Reviewç¯èŠ‚å¿…é¡»ä¸¥æ ¼ï¼Œä¸èƒ½æ•·è¡
- æ–‡ä»¶æ ¼å¼è¦ç²¾ç¡®ï¼Œå› ä¸ºplan-parserä¾èµ–å®ƒ
- **æ–‡ä»¶å‘½åè§„èŒƒä¸¥æ ¼**ï¼š
  - æ‹†åˆ†æ¶æ„ï¼š`task-name/README.md` + `stages/01-name.md`
  - å•æ–‡ä»¶ï¼š`task-name.md`
- Stageæ•°é‡å»ºè®®3-8ä¸ªï¼ˆå¤ªå¤šä¼šå¢åŠ ç®¡ç†è´Ÿæ‹…ï¼‰
- **è¡Œæ•°å»ºè®®**ï¼š
  - æ‹†åˆ†æ¶æ„ï¼šæ¯ä¸ªStage 600-1000è¡Œï¼ˆtokençº¦900-1500ï¼‰
  - å•æ–‡ä»¶æ¶æ„ï¼šæ€»è®¡1500-3000è¡Œï¼ˆé€‚åˆç®€å•ä»»åŠ¡ï¼‰
- ç¤ºä¾‹è¦çœŸå®ã€é«˜è´¨é‡ï¼Œä½œä¸ºAIå­¦ä¹ çš„èŒƒæœ¬
- æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡è¾“å…¥
- **Phase 3æ™ºèƒ½ç”Ÿæˆç­–ç•¥**ï¼š
  - å•æ–‡ä»¶æ¶æ„ï¼šç›´æ¥ä¸€æ¬¡æ€§ç”Ÿæˆï¼ˆé€šå¸¸ä¸è¶…è¿‡3000è¡Œï¼‰
  - æ‹†åˆ†æ¶æ„ï¼šå¦‚æœStageæ•°â‰¤3å¯ä¸€æ¬¡ç”Ÿæˆï¼Œå¦åˆ™é€ä¸ªç”Ÿæˆ
  - æ¯ç”Ÿæˆä¸€ä¸ªStageåï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦ç»§ç»­æˆ–è°ƒæ•´

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# æµ‹è¯•é¢„å¤„ç†å™¨
node -e "import('./src/commands/plan-preprocessor.js').then(m => {
  console.log(m.preprocess('/plan --force-split test task'));
})"
# åº”è¾“å‡º: { architecture: 'split', taskDesc: 'test task' }

# æµ‹è¯•æ¨¡æ¿åŠ è½½
ls templates/plan-templates/
# åº”æ˜¾ç¤º: refactor.yaml, feature.yaml, bugfix.yaml, docs.yaml

# åœ¨Claude Codeä¸­æµ‹è¯• - è‡ªåŠ¨åˆ¤æ–­æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
/plan æˆ‘è¦é‡æ„authæ¨¡å—ï¼Œæ”¯æŒOAuth2.0
# AIåº”è¯¥åˆ†æä»»åŠ¡å¤æ‚åº¦å¹¶æ¨èæ¶æ„

# æµ‹è¯•å¼ºåˆ¶æ‹†åˆ†æ¶æ„
/plan --force-split ç®€å•çš„é…ç½®æ–‡ä»¶æ›´æ–°
# å³ä½¿ä»»åŠ¡ç®€å•ï¼Œä¹Ÿåº”ç”Ÿæˆæ‹†åˆ†æ¶æ„

# æµ‹è¯•å¼ºåˆ¶å•æ–‡ä»¶æ¶æ„
/plan --force-single é‡æ„æ•´ä¸ªè®¤è¯ç³»ç»Ÿ
# å³ä½¿ä»»åŠ¡å¤æ‚ï¼Œä¹Ÿåº”ç”Ÿæˆå•æ–‡ä»¶

# æµ‹è¯•æ¨¡æ¿
/plan --template refactor é‡æ„authæ¨¡å—
# åº”åŠ è½½ refactor æ¨¡æ¿å¹¶åŸºäºå®ƒç”Ÿæˆ

# æµ‹è¯•é•¿æ ¼å¼å‚æ•°
/plan --architecture split æ·»åŠ æ–°çš„APIç«¯ç‚¹

# æµ‹è¯•æ–‡æ¡£å¼•ç”¨
/plan @docs/requirements.md --force-split ç”Ÿæˆæ‰§è¡Œè®¡åˆ’

# éªŒè¯æ‹†åˆ†æ¶æ„è¾“å‡º
tree .ccautorun/plans/auth-oauth2-refactor/
# åº”è¾“å‡º:
# auth-oauth2-refactor/
# â”œâ”€â”€ README.md
# â””â”€â”€ stages/
#     â”œâ”€â”€ 01-database-design.md
#     â”œâ”€â”€ 02-api-implementation.md
#     â””â”€â”€ ...

# éªŒè¯å•æ–‡ä»¶æ¶æ„è¾“å‡º
ls .ccautorun/plans/config-update.md
# åº”å­˜åœ¨å•ä¸ªæ–‡ä»¶

# éªŒè¯README.mdæ ¼å¼ï¼ˆæ‹†åˆ†æ¶æ„ï¼‰
head -20 .ccautorun/plans/auth-oauth2-refactor/README.md
# åº”åŒ…å« AUTO-RUN-CONFIG å’Œ architecture: split

# éªŒè¯å•æ–‡ä»¶æ ¼å¼
head -20 .ccautorun/plans/config-update.md
# åº”åŒ…å« AUTO-RUN-CONFIG å’Œ architecture: single

# éªŒè¯plan-parserå¯ä»¥è§£æä¸¤ç§æ¶æ„
ccautorun status auth-oauth2-refactor
# åº”æ˜¾ç¤ºæ¶æ„ç±»å‹ï¼šsplit
ccautorun status config-update
# åº”æ˜¾ç¤ºæ¶æ„ç±»å‹ï¼šsingle

# éªŒè¯tokenæ•ˆç‡
wc -l .ccautorun/plans/auth-oauth2-refactor/stages/*.md
# æ¯ä¸ªæ–‡ä»¶åº”åœ¨600-1000è¡Œä¹‹é—´
wc -l .ccautorun/plans/config-update.md
# å•æ–‡ä»¶åº”åœ¨1500-3000è¡Œä¹‹é—´
```

---

## Stage 5: é€šçŸ¥ã€CLIå¢å¼ºå’Œç‰ˆæœ¬ç®¡ç†ï¼ˆæ‹†åˆ†æ¶æ„ï¼‰ğŸ”„

### ğŸ¯ ç›®æ ‡
å®ç°æ¡Œé¢é€šçŸ¥ï¼ˆå†…ç½®åˆ°Hookï¼‰ã€å®æ—¶è¿›åº¦ç›‘æ§ï¼ˆwatchï¼‰ã€é…ç½®è¿ç§»ï¼Œ**å®Œæ•´æ”¯æŒæ‹†åˆ†æ¶æ„**

### ğŸ“ ä»»åŠ¡æ¸…å•
- [ ] å®ç° `ccautorun watch <task-name>` å‘½ä»¤ï¼ˆå®æ—¶è¿›åº¦æ˜¾ç¤ºï¼Œå…³é”®ï¼ï¼‰
  - **é»˜è®¤å¼€å¯**ï¼šæ‰§è¡Œä»»åŠ¡æ—¶è‡ªåŠ¨å¯åŠ¨ watch
  - å®æ—¶æ˜¾ç¤ºä»»åŠ¡è¿›åº¦ï¼š
    - å½“å‰ Stageï¼ˆå¦‚ "Stage 2/5: API Implementation"ï¼‰
    - å®Œæˆç™¾åˆ†æ¯”ï¼ˆ40%ï¼‰
    - è¿›åº¦æ¡å¯è§†åŒ–ï¼ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ï¼‰
    - å·²ç”¨æ—¶é—´ï¼ˆå¦‚ "Elapsed: 12m 34s"ï¼‰
    - é¢„è®¡å‰©ä½™æ—¶é—´ï¼ˆåŸºäºå¹³å‡é€Ÿåº¦ï¼‰
  - ç›‘æ§æ–¹å¼ï¼š
    - ä½¿ç”¨ chokidar ç›‘æ§ä¼šè¯æ–‡ä»¶å’Œè®¡åˆ’æ–‡æ¡£çš„å˜åŒ–
    - æ£€æµ‹ä¼šè¯çŠ¶æ€å˜åŒ–ï¼ˆactive/paused/failed/completedï¼‰
    - æ£€æµ‹è¿›åº¦å˜åŒ–ï¼ˆcurrent å­—æ®µï¼‰
  - çŠ¶æ€å˜åŒ–é€šçŸ¥ï¼š
    - Stage å®Œæˆæ—¶æ˜¾ç¤ºé€šçŸ¥
    - å‡ºç°é”™è¯¯æ—¶æ˜¾ç¤ºè­¦å‘Š
    - ä»»åŠ¡å®Œæˆæ—¶æ˜¾ç¤ºæ€»ç»“
  - æ”¯æŒ `--interval <seconds>` è®¾ç½®åˆ·æ–°é—´éš”ï¼ˆé»˜è®¤ 2 ç§’ï¼‰
  - æ”¯æŒ `--no-notify` ç¦ç”¨æ¡Œé¢é€šçŸ¥
  - æ”¯æŒ Ctrl+C ä¼˜é›…é€€å‡º
- [ ] å®ç° `src/utils/notifier.js`
  - ä½¿ç”¨node-notifierè·¨å¹³å°é€šçŸ¥
  - æ”¯æŒæ ‡é¢˜ã€æ¶ˆæ¯ã€å›¾æ ‡ã€å£°éŸ³ï¼ˆåŸºäºé…ç½®ï¼‰
  - é”™è¯¯å¤„ç†ï¼ˆé€šçŸ¥å¤±è´¥ä¸å½±å“ä¸»æµç¨‹ï¼‰
  - æä¾›ç»Ÿä¸€çš„é€šçŸ¥æ¥å£ï¼š
    - `notifyProgress(taskName, stage, total)` - è¿›åº¦é€šçŸ¥
    - `notifyError(taskName, error, suggestion)` - é”™è¯¯é€šçŸ¥
    - `notifyComplete(taskName, stats)` - å®Œæˆé€šçŸ¥
    - `notifyWarning(taskName, message)` - è­¦å‘Šé€šçŸ¥
- [ ] å°†é€šçŸ¥åŠŸèƒ½é›†æˆåˆ° Hookï¼ˆ`src/hooks/auto-continue.js`ï¼‰
  - Stage å¼€å§‹æ—¶å‘é€é€šçŸ¥
  - Stage å®Œæˆæ—¶å‘é€é€šçŸ¥ï¼ˆå¸¦è¿›åº¦ç™¾åˆ†æ¯”ï¼‰
  - é”™è¯¯æ—¶å‘é€é€šçŸ¥
  - æš‚åœ/è¾¾åˆ°é™åˆ¶æ—¶å‘é€é€šçŸ¥
  - æ ¹æ® config.yaml çš„ `notifications.progress_frequency` æ§åˆ¶é¢‘ç‡
- [ ] å®ç° `ccautorun config` å‘½ä»¤ï¼ˆå¢å¼ºï¼‰
  - äº¤äº’å¼é…ç½®å‘å¯¼ï¼ˆinquirerï¼‰
  - é…ç½®é¡¹ï¼š
    - é»˜è®¤æ¶æ„ç±»å‹ï¼ˆauto/split/singleï¼‰
    - å®‰å…¨é™åˆ¶ç­–ç•¥ï¼ˆunlimited/æ•°å­—ï¼‰
    - é€šçŸ¥åå¥½ï¼ˆenabled, sound, progress_frequencyï¼‰
    - è‡ªåŠ¨ç»§ç»­å¼€å…³ï¼ˆenabled, skip_permissionsï¼‰
    - é»˜è®¤ç¼–è¾‘å™¨ï¼ˆcode, vim, etcï¼‰
  - æ”¯æŒ `--get <key>` æŸ¥è¯¢å•ä¸ªé…ç½®
  - æ”¯æŒ `--set <key> <value>` ä¿®æ”¹å•ä¸ªé…ç½®
  - æ”¯æŒ `--list` åˆ—å‡ºæ‰€æœ‰é…ç½®
  - é…ç½®éªŒè¯ï¼ˆä½¿ç”¨ config-validatorï¼‰
  - ä¿å­˜åˆ° `.ccautorun/config.yaml`
- [ ] å®ç° `ccautorun migrate` å‘½ä»¤ï¼ˆç‰ˆæœ¬è¿ç§»ï¼‰
  - æ£€æŸ¥ config.yaml çš„ version å­—æ®µ
  - å¦‚æœç‰ˆæœ¬è¿‡æ—§ï¼Œæç¤ºéœ€è¦è¿ç§»
  - æ‰§è¡Œè‡ªåŠ¨è¿ç§»ï¼š
    - v1.x â†’ v2.0: æ·»åŠ æ–°å­—æ®µï¼Œä¿ç•™æ—§é…ç½®
    - æ›´æ–° version å­—æ®µ
  - å¤‡ä»½æ—§é…ç½®ï¼ˆ`config.yaml.backup`ï¼‰
  - è¾“å‡ºè¿ç§»æ—¥å¿—
  - æ”¯æŒ `--dry-run` é¢„è§ˆè¿ç§»
- [ ] å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥é…ç½®ç‰ˆæœ¬
  - åœ¨ `src/cli.js` ä¸­æ·»åŠ ç‰ˆæœ¬æ£€æŸ¥
  - å¦‚æœç‰ˆæœ¬ä¸åŒ¹é…ï¼Œæç¤ºè¿è¡Œ `ccautorun migrate`
  - ä¸é˜»æ­¢å‘½ä»¤æ‰§è¡Œï¼ˆé™¤éé…ç½®æ ¼å¼å®Œå…¨æ— æ³•è§£æï¼‰
- [ ] å®ç° `ccautorun archive [task-name]` å‘½ä»¤ï¼ˆæ”¯æŒæ‹†åˆ†æ¶æ„ï¼‰
  - å°†å®Œæˆçš„ä»»åŠ¡ç§»åˆ° `.ccautorun/archive/`
  - **æ‹†åˆ†æ¶æ„**ï¼šç§»åŠ¨æ•´ä¸ªç›®å½• `xxx/`
  - **å•æ–‡ä»¶**ï¼šç§»åŠ¨ `xxx.md`
  - ä¿ç•™ä¼šè¯å†å²æ–‡ä»¶
  - è¾“å‡ºç®€å•æ‘˜è¦ï¼ˆä»»åŠ¡åã€å®ŒæˆStageæ•°ã€æ€»è€—æ—¶ï¼‰
- [ ] å¢å¼º `ccautorun list` å‘½ä»¤ï¼ˆæ‹†åˆ†æ¶æ„å¯è§†åŒ–ï¼‰
  - æ·»åŠ è¿›åº¦æ¡å¯è§†åŒ–
  - å½©è‰²çŠ¶æ€æ˜¾ç¤º
  - **æ˜¾ç¤ºæ¶æ„ç±»å‹æ ‡è¯†**ï¼šğŸ“ (split) æˆ– ğŸ“„ (single)
  - æ”¯æŒ `--filter` é€‰é¡¹ï¼ˆè¿›è¡Œä¸­/å·²å®Œæˆï¼‰
  - **æ‹†åˆ†æ¶æ„é¢å¤–ä¿¡æ¯**ï¼šStageæ–‡ä»¶æ•°é‡
- [ ] å¢å¼º `ccautorun status` å‘½ä»¤ï¼ˆæ‹†åˆ†æ¶æ„è¯¦ç»†æ˜¾ç¤ºï¼‰
  - æ˜¾ç¤ºå®Œæ•´çš„é˜¶æ®µæ ‘ï¼š
    - **å•æ–‡ä»¶**ï¼šåˆ—å‡ºStage 1, 2, 3...
    - **æ‹†åˆ†æ¶æ„**ï¼šåˆ—å‡º `stages/01-xxx.md`, `02-yyy.md`...
  - ä»»åŠ¡å®Œæˆæƒ…å†µ
  - **æ‹†åˆ†æ¶æ„**ï¼šæ˜¾ç¤ºæ¯ä¸ªStageæ–‡ä»¶å¤§å°å’Œtokenä¼°ç®—
  - ä¼šè¯å†å²

### âœ… å®Œæˆæ ‡å‡†
- [ ] **watch å‘½ä»¤å¯ä»¥å®æ—¶æ˜¾ç¤ºè¿›åº¦**ï¼ˆå…³é”®ï¼ï¼‰
- [ ] watch é»˜è®¤å¼€å¯ï¼ˆæ‰§è¡Œä»»åŠ¡æ—¶è‡ªåŠ¨å¯åŠ¨ï¼‰
- [ ] watch å¯ä»¥ç›‘æ§ä¼šè¯å’Œè®¡åˆ’æ–‡æ¡£å˜åŒ–
- [ ] watch æ˜¾ç¤ºè¿›åº¦æ¡ã€ç™¾åˆ†æ¯”ã€å·²ç”¨æ—¶é—´ã€é¢„è®¡å‰©ä½™æ—¶é—´
- [ ] watch æ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–æ—¶å‘é€é€šçŸ¥
- [ ] watch æ”¯æŒ --interval å’Œ --no-notify é€‰é¡¹
- [ ] watch å¯ä»¥ä¼˜é›…é€€å‡ºï¼ˆCtrl+Cï¼‰
- [ ] æ¡Œé¢é€šçŸ¥åœ¨Mac/Win/Linuxä¸Šéƒ½èƒ½å·¥ä½œ
- [ ] notifier æä¾›ç»Ÿä¸€æ¥å£ï¼ˆprogress/error/complete/warningï¼‰
- [ ] **Hook é›†æˆé€šçŸ¥**ï¼šStage å¼€å§‹/å®Œæˆ/é”™è¯¯æ—¶è‡ªåŠ¨é€šçŸ¥
- [ ] é€šçŸ¥é¢‘ç‡å¯é…ç½®ï¼ˆevery-stage / every-2-stages / offï¼‰
- [ ] configå‘½ä»¤å¯ä»¥äº¤äº’å¼é…ç½®æ‰€æœ‰é¡¹
- [ ] configæ”¯æŒ --get/--set/--list å­å‘½ä»¤
- [ ] configå¯ä»¥é…ç½®é»˜è®¤æ¶æ„ç±»å‹ã€é€šçŸ¥ã€ç¼–è¾‘å™¨ç­‰
- [ ] é…ç½®ä¿å­˜åˆ°yamlæ–‡ä»¶å¹¶é€šè¿‡éªŒè¯
- [ ] **migrate å‘½ä»¤å·¥ä½œæ­£å¸¸**ï¼š
  - å¯ä»¥æ£€æµ‹é…ç½®ç‰ˆæœ¬
  - å¯ä»¥æ‰§è¡Œè‡ªåŠ¨è¿ç§»
  - æ”¯æŒ --dry-run
  - å¤‡ä»½æ—§é…ç½®
- [ ] å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥é…ç½®ç‰ˆæœ¬å¹¶æç¤º
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šarchiveå¯ä»¥æ­£ç¡®ç§»åŠ¨æ•´ä¸ªç›®å½•
- [ ] **å•æ–‡ä»¶**ï¼šarchiveå¯ä»¥æ­£ç¡®ç§»åŠ¨å•ä¸ªæ–‡ä»¶
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šlistæ˜¾ç¤ºğŸ“æ ‡è¯†å’ŒStageæ•°é‡
- [ ] **å•æ–‡ä»¶**ï¼šlistæ˜¾ç¤ºğŸ“„æ ‡è¯†
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šstatusæ˜¾ç¤ºæ‰€æœ‰stageæ–‡ä»¶æ¸…å•
- [ ] **æ‹†åˆ†æ¶æ„**ï¼šstatusæ˜¾ç¤ºæ¯ä¸ªstageæ–‡ä»¶tokenä¼°ç®—
- [ ] listå’Œstatuså‘½ä»¤æœ‰æ¼‚äº®çš„å¯è§†åŒ–è¾“å‡º
- [ ] æ‰€æœ‰å‘½ä»¤å¯¹ä¸¤ç§æ¶æ„éƒ½æœ‰å®Œæ•´çš„é”™è¯¯å¤„ç†

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `src/commands/watch.js` (250è¡Œï¼Œæ–°å¢ï¼Œä½¿ç”¨ chokidarï¼‰
- [ ] `src/utils/notifier.js` (120è¡Œï¼Œå¢åŠ ç»Ÿä¸€æ¥å£ï¼‰
- [ ] æ›´æ–° `src/hooks/auto-continue.js` (å¢åŠ 100è¡Œï¼Œé›†æˆé€šçŸ¥ï¼‰
- [ ] `src/commands/config.js` (300è¡Œï¼Œå·²åœ¨ Stage 2bï¼‰
- [ ] `src/commands/migrate.js` (180è¡Œï¼Œæ–°å¢ï¼‰
- [ ] æ›´æ–° `src/cli.js` (å¢åŠ 30è¡Œï¼Œç‰ˆæœ¬æ£€æŸ¥ï¼‰
- [ ] `src/commands/archive.js` (150è¡Œï¼Œå¢åŠ æ‹†åˆ†æ¶æ„å½’æ¡£)
- [ ] æ›´æ–° `src/commands/list.js` (å¢åŠ 150è¡Œï¼Œæ¶æ„ç±»å‹æ˜¾ç¤º)
- [ ] æ›´æ–° `src/commands/status.js` (å¢åŠ 120è¡Œï¼Œæ‹†åˆ†æ¶æ„è¯¦ç»†æ˜¾ç¤º)

### âš ï¸ æ³¨æ„äº‹é¡¹
- **watch å‘½ä»¤æ˜¯æ ¸å¿ƒç”¨æˆ·ä½“éªŒ**ï¼š
  - é»˜è®¤å¼€å¯ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨å¯åŠ¨
  - ä½¿ç”¨ chokidar ç›‘æ§æ–‡ä»¶å˜åŒ–ï¼Œé«˜æ•ˆä¸”è·¨å¹³å°
  - è¿›åº¦æ¡ä½¿ç”¨ Unicode å­—ç¬¦ï¼ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ï¼‰ï¼Œæ³¨æ„ç»ˆç«¯å…¼å®¹æ€§
  - ä¼˜é›…é€€å‡ºï¼ˆCtrl+Cï¼‰ï¼Œæ¸…ç†èµ„æº
  - é¢„è®¡å‰©ä½™æ—¶é—´åŸºäºå¹³å‡é€Ÿåº¦ï¼Œå¯èƒ½ä¸å‡†ç¡®ï¼ˆæç¤ºç”¨æˆ·ï¼‰
- node-notifieråœ¨ä¸åŒå¹³å°è¡Œä¸ºç•¥æœ‰å·®å¼‚ï¼Œéœ€è¦æµ‹è¯•
- **é€šçŸ¥é›†æˆåˆ°Hook**ï¼šä¸éœ€è¦å•ç‹¬çš„ monitor å‘½ä»¤ï¼ŒHook è‡ªåŠ¨å‘é€é€šçŸ¥
- **é€šçŸ¥é¢‘ç‡æ§åˆ¶**ï¼šæ ¹æ® config.yaml çš„ progress_frequency å†³å®šæ˜¯å¦å‘é€
- **migrate å‘½ä»¤ç®€å•å³å¯**ï¼šåªå¤„ç†ç®€å•çš„å­—æ®µæ·»åŠ ï¼Œä¸åšå¤æ‚è¿ç§»
- **ç‰ˆæœ¬æ£€æŸ¥ä¸é˜»å¡**ï¼šå³ä½¿ç‰ˆæœ¬ä¸åŒ¹é…ä¹Ÿå…è®¸å‘½ä»¤æ‰§è¡Œï¼Œåªæ˜¯æç¤º
- inquirerçš„é—®é¢˜è®¾è®¡è¦æ¸…æ™°æ˜“æ‡‚
- **config --get/--set**ï¼šæ”¯æŒåµŒå¥—é”®ï¼ˆå¦‚ `notifications.enabled`ï¼‰
- **å½’æ¡£æ—¶æ£€æŸ¥æ¶æ„ç±»å‹**ï¼šé¿å…è¯¯åˆ æ–‡ä»¶
- **tokenä¼°ç®—**ï¼šæŒ‰æ¯è¡Œ2.5 tokensè®¡ç®—ï¼ˆç²—ç•¥ä¼°ç®—ï¼Œå®é™…å€¼å–å†³äºå†…å®¹å¤æ‚åº¦ï¼‰ï¼Œå»ºè®®å®é™…æµ‹è¯•ä¸­ä½¿ç”¨Claude Codeçš„tokenè®¡æ•°éªŒè¯
- **Windows å…¼å®¹æ€§**ï¼šä½¿ç”¨ Node.js API è¿›è¡Œæ–‡ä»¶æ“ä½œå’Œæ˜¾ç¤º

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# æµ‹è¯• watch å‘½ä»¤ï¼ˆå…³é”®ï¼ï¼‰
ccautorun watch test-task
# åº”å®æ—¶æ˜¾ç¤ºè¿›åº¦æ¡ã€ç™¾åˆ†æ¯”ã€å·²ç”¨æ—¶é—´
# æ£€æµ‹åˆ°å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°

ccautorun watch test-task --interval 1        # 1ç§’åˆ·æ–°
ccautorun watch test-task --no-notify         # ç¦ç”¨é€šçŸ¥
# Ctrl+C åº”ä¼˜é›…é€€å‡º

# æµ‹è¯•é€šçŸ¥æ¥å£
node -e "import('./src/utils/notifier.js').then(m => {
  m.notifyProgress('test-task', 2, 5);
  m.notifyError('test-task', 'Something wrong', 'Try ccautorun doctor');
})"

# æµ‹è¯•é€šçŸ¥é›†æˆåˆ° Hookï¼ˆæ¨¡æ‹Ÿï¼‰
# Hook æ‰§è¡Œæ—¶åº”è‡ªåŠ¨å‘é€é€šçŸ¥

# æµ‹è¯•configäº¤äº’å¼
ccautorun config
# åº”æ˜¾ç¤ºæ‰€æœ‰é…ç½®é¡¹ï¼ŒåŒ…æ‹¬æ¶æ„ã€é€šçŸ¥ã€ç¼–è¾‘å™¨ç­‰

# æµ‹è¯•config --get
ccautorun config --get default_architecture
# åº”è¾“å‡º: auto (æˆ– split/single)

ccautorun config --get notifications.enabled
# åº”è¾“å‡º: true (æˆ– false)

# æµ‹è¯•config --set
ccautorun config --set default_architecture split
ccautorun config --set notifications.sound false

# æµ‹è¯•config --list
ccautorun config --list
# åº”åˆ—å‡ºæ‰€æœ‰é…ç½®é¡¹å’Œå€¼

# æµ‹è¯•migrate
ccautorun migrate --dry-run
# åº”æ˜¾ç¤ºå°†è¦æ‰§è¡Œçš„è¿ç§»æ“ä½œ

ccautorun migrate
# åº”æ‰§è¡Œè¿ç§»ï¼Œå¤‡ä»½æ—§é…ç½®ï¼Œæ›´æ–°versionå­—æ®µ

# æµ‹è¯•ç‰ˆæœ¬æ£€æŸ¥
# ä¿®æ”¹ config.yaml çš„ version ä¸ºæ—§ç‰ˆæœ¬
ccautorun list
# åº”æ˜¾ç¤ºç‰ˆæœ¬ä¸åŒ¹é…è­¦å‘Šå’Œ migrate æç¤º

# æµ‹è¯•æ‹†åˆ†æ¶æ„çš„list
ccautorun list
# åº”æ˜¾ç¤ºï¼š
# ğŸ“ auth-oauth2-refactor (3/5 stages) [40%] â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘

# æµ‹è¯•æ‹†åˆ†æ¶æ„çš„status
ccautorun status auth-oauth2-refactor
# åº”æ˜¾ç¤ºï¼š
# Architecture: split
# Stages:
#   âœ… 01-database-design.md (850 lines, ~2125 tokens)
#   ğŸ”„ 02-api-implementation.md (920 lines, ~2300 tokens)
#   â³ 03-testing.md (780 lines, ~1950 tokens)

# æµ‹è¯•æ‹†åˆ†æ¶æ„å½’æ¡£
ccautorun archive auth-oauth2-refactor
# åº”ç§»åŠ¨æ•´ä¸ª auth-oauth2-refactor/ ç›®å½•åˆ° .ccautorun/archive/
ls .ccautorun/archive/auth-oauth2-refactor/README.md
```

---

## Stage 5.5: æµ‹è¯•åŸºç¡€è®¾æ–½å’Œæµ‹è¯•è¦†ç›– ğŸ§ª

### ğŸ¯ ç›®æ ‡
å»ºç«‹å®Œæ•´çš„æµ‹è¯•åŸºç¡€è®¾æ–½ï¼Œç¡®ä¿æ ¸å¿ƒåŠŸèƒ½çš„ç¨³å®šæ€§å’Œå¯é æ€§ï¼Œè¦†ç›–ç‡è¾¾åˆ° 70%+

### ğŸ“ ä»»åŠ¡æ¸…å•
- [ ] é…ç½® Vitest æµ‹è¯•æ¡†æ¶
  - åˆ›å»º `vitest.config.js`
  - é…ç½® ES Modules æ”¯æŒ
  - é…ç½®è¦†ç›–ç‡æŠ¥å‘Šï¼ˆc8 æˆ– v8ï¼‰
  - è®¾ç½®æµ‹è¯•ç¯å¢ƒï¼ˆNode.jsï¼‰
  - é…ç½®æµ‹è¯•è¶…æ—¶å’Œé‡è¯•
  - æ·»åŠ  npm scriptsï¼š
    - `npm test` - è¿è¡Œæ‰€æœ‰æµ‹è¯•
    - `npm run test:watch` - watch æ¨¡å¼
    - `npm run test:coverage` - ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
    - `npm run test:ui` - å¯åŠ¨æµ‹è¯• UI

- [ ] å•å…ƒæµ‹è¯• - æ ¸å¿ƒæ¨¡å—ï¼ˆ`tests/unit/`ï¼‰
  - [ ] `tests/unit/plan-parser.test.js`ï¼ˆå…³é”®ï¼ï¼‰
    - æµ‹è¯•æ‹†åˆ†æ¶æ„è§£æï¼ˆREADME.md + stages/ï¼‰
    - æµ‹è¯•å•æ–‡ä»¶æ¶æ„è§£æï¼ˆtask-name.mdï¼‰
    - æµ‹è¯•é…ç½®å¤´è§£æï¼ˆAUTO-RUN-CONFIGï¼‰
    - æµ‹è¯• Stage æ–‡ä»¶è¯»å–å’Œé¡ºåº
    - æµ‹è¯•é”™è¯¯å¤„ç†ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æ ¼å¼é”™è¯¯ç­‰ï¼‰
    - æµ‹è¯•æ¶æ„ç±»å‹æ£€æµ‹
    - è‡³å°‘ 15 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - [ ] `tests/unit/session-manager.test.js`
    - æµ‹è¯•ä¼šè¯åˆ›å»ºå’Œåˆå§‹åŒ–
    - æµ‹è¯•ä¼šè¯çŠ¶æ€æ›´æ–°ï¼ˆactive/paused/failed/completedï¼‰
    - æµ‹è¯•åŸå­å†™å…¥æœºåˆ¶ï¼ˆtmp + renameï¼‰
    - æµ‹è¯• failed çŠ¶æ€å’Œ lastError è®°å½•
    - æµ‹è¯•ä¼šè¯æŸ¥è¯¢å’Œåˆ—è¡¨
    - æµ‹è¯•å¹¶å‘å†™å…¥å®‰å…¨æ€§
    - è‡³å°‘ 12 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - [ ] `tests/unit/safety-limiter.test.js`
    - æµ‹è¯•å®‰å…¨é™åˆ¶æ£€æŸ¥
    - æµ‹è¯• unlimited æ¨¡å¼
    - æµ‹è¯•æ•°å­—é™åˆ¶æ¨¡å¼
    - æµ‹è¯•é™åˆ¶è¾¾åˆ°æ—¶çš„è¡Œä¸º
    - æµ‹è¯•é™åˆ¶é‡ç½®
    - è‡³å°‘ 8 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - [ ] `tests/unit/config-validator.test.js`
    - æµ‹è¯•é…ç½®æ ¼å¼éªŒè¯
    - æµ‹è¯•å¿…å¡«å­—æ®µæ£€æŸ¥
    - æµ‹è¯•æ•°æ®ç±»å‹éªŒè¯
    - æµ‹è¯•é»˜è®¤å€¼åº”ç”¨
    - æµ‹è¯•ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥
    - è‡³å°‘ 10 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - [ ] `tests/unit/notifier.test.js`
    - æµ‹è¯•é€šçŸ¥æ¥å£ï¼ˆprogress/error/complete/warningï¼‰
    - æµ‹è¯•è·¨å¹³å°å…¼å®¹æ€§ï¼ˆmock node-notifierï¼‰
    - æµ‹è¯•é”™è¯¯å¤„ç†ï¼ˆé€šçŸ¥å¤±è´¥ä¸å½±å“ä¸»æµç¨‹ï¼‰
    - è‡³å°‘ 6 ä¸ªæµ‹è¯•ç”¨ä¾‹

- [ ] é›†æˆæµ‹è¯• - CLI å‘½ä»¤ï¼ˆ`tests/integration/`ï¼‰
  - [ ] `tests/integration/commands/init.test.js`
    - æµ‹è¯•é¡¹ç›®åˆå§‹åŒ–
    - æµ‹è¯•ç›®å½•ç»“æ„åˆ›å»º
    - æµ‹è¯•é…ç½®æ–‡ä»¶ç”Ÿæˆ
    - æµ‹è¯• hook è‡ªåŠ¨é…ç½®ï¼ˆ--setup-hooksï¼‰
    - æµ‹è¯•å·²å­˜åœ¨é¡¹ç›®çš„å¤„ç†
    - è‡³å°‘ 8 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - [ ] `tests/integration/commands/list-status.test.js`
    - æµ‹è¯• list å‘½ä»¤ï¼ˆä¸¤ç§æ¶æ„ï¼‰
    - æµ‹è¯• status å‘½ä»¤ï¼ˆä¸¤ç§æ¶æ„ï¼‰
    - æµ‹è¯•ç©ºä»»åŠ¡åˆ—è¡¨
    - æµ‹è¯•è¿›åº¦æ˜¾ç¤º
    - æµ‹è¯•æ¶æ„ç±»å‹æ ‡è¯†ï¼ˆğŸ“/ğŸ“„ï¼‰
    - è‡³å°‘ 10 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - [ ] `tests/integration/commands/control.test.js`
    - æµ‹è¯• pause/resume å‘½ä»¤
    - æµ‹è¯• skip å‘½ä»¤
    - æµ‹è¯• retry å‘½ä»¤
    - æµ‹è¯• recover å‘½ä»¤
    - æµ‹è¯•çŠ¶æ€è½¬æ¢
    - è‡³å°‘ 10 ä¸ªæµ‹è¯•ç”¨ä¾‹
  - [ ] `tests/integration/commands/config.test.js`
    - æµ‹è¯• config äº¤äº’å¼é…ç½®
    - æµ‹è¯• --get/--set/--list
    - æµ‹è¯•é…ç½®æŒä¹…åŒ–
    - æµ‹è¯•é…ç½®éªŒè¯
    - è‡³å°‘ 8 ä¸ªæµ‹è¯•ç”¨ä¾‹

- [ ] Hook æµ‹è¯•ï¼ˆ`tests/hooks/`ï¼‰
  - [ ] `tests/hooks/auto-continue.test.js`ï¼ˆå…³é”®ï¼ï¼‰
    - æµ‹è¯• Hook è§¦å‘æœºåˆ¶
    - æµ‹è¯•ä¸‰å±‚é™çº§ç­–ç•¥ï¼š
      - ä¸»ç­–ç•¥ï¼štranscript æ ‡è®°æ£€æµ‹
      - é™çº§1ï¼šç‹¬ç«‹æ ‡è®°æ–‡ä»¶
      - é™çº§2ï¼šæ–‡ä»¶ä¿®æ”¹æ—¶é—´
      - æœ€ç»ˆé™çº§ï¼šç”¨æˆ·é€šçŸ¥
    - æµ‹è¯•é”™è¯¯æ£€æµ‹å’Œ failed çŠ¶æ€
    - æµ‹è¯•å®‰å…¨é™åˆ¶é›†æˆ
    - æµ‹è¯•é€šçŸ¥é›†æˆ
    - æµ‹è¯• --dangerously-skip-permissions æ¨¡å¼
    - Mock Claude Code transcript æ–‡ä»¶
    - è‡³å°‘ 15 ä¸ªæµ‹è¯•ç”¨ä¾‹

- [ ] E2E æµ‹è¯•ï¼ˆ`tests/e2e/`ï¼‰
  - [ ] `tests/e2e/full-workflow.test.js`
    - æµ‹è¯•å®Œæ•´å·¥ä½œæµï¼š
      1. init åˆå§‹åŒ–é¡¹ç›®
      2. æ¨¡æ‹Ÿ /plan ç”Ÿæˆè®¡åˆ’ï¼ˆæ‹†åˆ†æ¶æ„ï¼‰
      3. æ¨¡æ‹Ÿæ‰§è¡Œç¬¬ä¸€ä¸ª Stage
      4. Hook è‡ªåŠ¨ç»§ç»­
      5. å®Œæˆæ‰€æœ‰ Stage
      6. éªŒè¯æœ€ç»ˆçŠ¶æ€
    - ä½¿ç”¨ä¸´æ—¶ç›®å½•éš”ç¦»æµ‹è¯•
    - è‡³å°‘ 3 ä¸ªå®Œæ•´æµç¨‹æµ‹è¯•ç”¨ä¾‹

- [ ] æµ‹è¯•å·¥å…·å’Œ Mockï¼ˆ`tests/helpers/`ï¼‰
  - [ ] `tests/helpers/fixtures.js`
    - åˆ›å»ºæµ‹è¯•ç”¨çš„è®¡åˆ’æ–‡æ¡£ fixtures
    - æ‹†åˆ†æ¶æ„ fixtureï¼ˆREADME + stagesï¼‰
    - å•æ–‡ä»¶æ¶æ„ fixture
    - å„ç§é…ç½®æ–‡ä»¶ fixtures
  - [ ] `tests/helpers/mock-fs.js`
    - Mock æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
    - æä¾›ä¸´æ—¶ç›®å½•ç®¡ç†
  - [ ] `tests/helpers/mock-claude.js`
    - Mock Claude Code transcript
    - Mock Hook è§¦å‘ç¯å¢ƒ
  - [ ] `tests/helpers/test-utils.js`
    - é€šç”¨æµ‹è¯•å·¥å…·å‡½æ•°
    - æ–­è¨€è¾…åŠ©å‡½æ•°

### âœ… å®Œæˆæ ‡å‡†
- [ ] Vitest é…ç½®å®Œæˆä¸”å¯ä»¥è¿è¡Œæµ‹è¯•
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡ï¼ˆè‡³å°‘ 51 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- [ ] æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡ï¼ˆè‡³å°‘ 36 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- [ ] Hook æµ‹è¯•é€šè¿‡ï¼ˆè‡³å°‘ 15 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- [ ] E2E æµ‹è¯•é€šè¿‡ï¼ˆè‡³å°‘ 3 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- [ ] æ€»æµ‹è¯•ç”¨ä¾‹æ•°ï¼š**105+**
- [ ] **æµ‹è¯•è¦†ç›–ç‡è¾¾åˆ° 70%+**ï¼ˆæ ¸å¿ƒæ¨¡å—ï¼‰
- [ ] è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆæ­£å¸¸
- [ ] æ‰€æœ‰æµ‹è¯•åœ¨ CI ç¯å¢ƒå¯è¿è¡Œï¼ˆå‡†å¤‡ GitHub Actionsï¼‰
- [ ] æµ‹è¯•è¿è¡Œæ—¶é—´ < 30 ç§’ï¼ˆä¸å« E2Eï¼‰
- [ ] æ²¡æœ‰ flaky testsï¼ˆä¸ç¨³å®šçš„æµ‹è¯•ï¼‰

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `vitest.config.js` (50è¡Œ)
- [ ] `tests/unit/plan-parser.test.js` (400è¡Œ)
- [ ] `tests/unit/session-manager.test.js` (350è¡Œ)
- [ ] `tests/unit/safety-limiter.test.js` (250è¡Œ)
- [ ] `tests/unit/config-validator.test.js` (300è¡Œ)
- [ ] `tests/unit/notifier.test.js` (200è¡Œ)
- [ ] `tests/integration/commands/init.test.js` (280è¡Œ)
- [ ] `tests/integration/commands/list-status.test.js` (350è¡Œ)
- [ ] `tests/integration/commands/control.test.js` (350è¡Œ)
- [ ] `tests/integration/commands/config.test.js` (280è¡Œ)
- [ ] `tests/hooks/auto-continue.test.js` (500è¡Œ)
- [ ] `tests/e2e/full-workflow.test.js` (400è¡Œ)
- [ ] `tests/helpers/fixtures.js` (200è¡Œ)
- [ ] `tests/helpers/mock-fs.js` (150è¡Œ)
- [ ] `tests/helpers/mock-claude.js` (180è¡Œ)
- [ ] `tests/helpers/test-utils.js` (120è¡Œ)
- [ ] **æ€»è®¡ï¼š~3,800 è¡Œæµ‹è¯•ä»£ç **

### âš ï¸ æ³¨æ„äº‹é¡¹
- **æµ‹è¯•ä¼˜å…ˆçº§**ï¼š
  - P0ï¼ˆå¿…é¡»ï¼‰ï¼šplan-parser, session-manager, auto-continue hook
  - P1ï¼ˆé‡è¦ï¼‰ï¼šsafety-limiter, config-validator, æ ¸å¿ƒå‘½ä»¤
  - P2ï¼ˆå¯é€‰ï¼‰ï¼šnotifier, è¾…åŠ©å‘½ä»¤
- **Hook æµ‹è¯•éš¾ç‚¹**ï¼š
  - éœ€è¦ Mock Claude Code çš„ transcript æ–‡ä»¶
  - éœ€è¦æ¨¡æ‹Ÿæ–‡ä»¶ä¿®æ”¹æ—¶é—´
  - éœ€è¦æµ‹è¯•å¼‚æ­¥è¡Œä¸ºå’Œå®šæ—¶å™¨
  - å»ºè®®ä½¿ç”¨ `vi.useFakeTimers()` æ§åˆ¶æ—¶é—´
- **E2E æµ‹è¯•éš”ç¦»**ï¼š
  - æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹çš„ä¸´æ—¶ç›®å½•
  - æµ‹è¯•åæ¸…ç†æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶
  - ä½¿ç”¨ `afterEach` ç¡®ä¿æ¸…ç†
- **è¦†ç›–ç‡ç›®æ ‡**ï¼š
  - æ ¸å¿ƒæ¨¡å—ï¼ˆparser, session, hookï¼‰ï¼š80%+
  - CLI å‘½ä»¤ï¼š60%+
  - å·¥å…·å‡½æ•°ï¼š70%+
  - æ€»ä½“ï¼š70%+
- **CI å‡†å¤‡**ï¼š
  - ç¡®ä¿æµ‹è¯•ä¸ä¾èµ–æœ¬åœ°ç¯å¢ƒ
  - ç¡®ä¿æµ‹è¯•å¯ä»¥å¹¶è¡Œè¿è¡Œ
  - å‡†å¤‡ `.github/workflows/test.yml`ï¼ˆåœ¨ Stage 6ï¼‰
- **æµ‹è¯•æ•°æ®**ï¼š
  - ä½¿ç”¨ fixtures ç›®å½•å­˜å‚¨æµ‹è¯•æ•°æ®
  - ä¸è¦åœ¨æµ‹è¯•ä¸­ç¡¬ç¼–ç é•¿å­—ç¬¦ä¸²
  - ä½¿ç”¨ `__dirname` æˆ– `import.meta.url` å®šä½æµ‹è¯•èµ„æº
- **Mock ç­–ç•¥**ï¼š
  - æ–‡ä»¶ç³»ç»Ÿï¼šä½¿ç”¨çœŸå®çš„ä¸´æ—¶ç›®å½•ï¼ˆä¸ç”¨ mock-fs åº“ï¼Œå…¼å®¹æ€§å·®ï¼‰
  - å¤–éƒ¨ä¾èµ–ï¼ˆnode-notifierï¼‰ï¼šä½¿ç”¨ vi.mock()
  - Claude Code transcriptï¼šä½¿ç”¨è‡ªå®šä¹‰ Mock
- **æµ‹è¯•å‘½åè§„èŒƒ**ï¼š
  - å•å…ƒæµ‹è¯•ï¼š`should [expected behavior] when [condition]`
  - é›†æˆæµ‹è¯•ï¼š`command should [expected behavior]`
  - E2E æµ‹è¯•ï¼š`full workflow: [scenario description]`

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test
# åº”æ˜¾ç¤º 105+ ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¦†ç›–ç‡
npm run test:coverage
# åº”æ˜¾ç¤ºè¦†ç›–ç‡ 70%+

# è¿è¡Œå•å…ƒæµ‹è¯•
npm test tests/unit
# åº”é€šè¿‡æ‰€æœ‰å•å…ƒæµ‹è¯•ï¼ˆ51+ ä¸ªï¼‰

# è¿è¡Œé›†æˆæµ‹è¯•
npm test tests/integration
# åº”é€šè¿‡æ‰€æœ‰é›†æˆæµ‹è¯•ï¼ˆ36+ ä¸ªï¼‰

# è¿è¡Œ Hook æµ‹è¯•
npm test tests/hooks
# åº”é€šè¿‡æ‰€æœ‰ Hook æµ‹è¯•ï¼ˆ15+ ä¸ªï¼‰

# è¿è¡Œ E2E æµ‹è¯•
npm test tests/e2e
# åº”é€šè¿‡æ‰€æœ‰ E2E æµ‹è¯•ï¼ˆ3+ ä¸ªï¼‰

# Watch æ¨¡å¼ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰
npm run test:watch

# æµ‹è¯• UIï¼ˆå¯è§†åŒ–ï¼‰
npm run test:ui
# åº”åœ¨æµè§ˆå™¨æ‰“å¼€æµ‹è¯•ç•Œé¢

# æµ‹è¯•ç‰¹å®šæ–‡ä»¶
npm test tests/unit/plan-parser.test.js

# æµ‹è¯•ç‰¹å®šç”¨ä¾‹ï¼ˆä½¿ç”¨ -t å‚æ•°ï¼‰
npm test -t "should parse split architecture"

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
open coverage/index.html
# åº”æ˜¾ç¤ºè¯¦ç»†çš„è¦†ç›–ç‡æŠ¥å‘Š
```

---

## Stage 7: æ–‡æ¡£ç¼–å†™å’Œå‘å¸ƒå‡†å¤‡ ğŸ”„

### ğŸ¯ ç›®æ ‡
ç¼–å†™å®Œæ•´çš„**ä¸­è‹±æ–‡åŒè¯­æ–‡æ¡£**ï¼ˆREADME + æ¨¡æ¿ï¼‰ï¼Œå‡†å¤‡GitHubå‘å¸ƒ

**æ˜ç¡®åŒè¯­èŒƒå›´**ï¼š
- âœ… åŒè¯­ï¼šREADME.md, README_CN.md, è®¡åˆ’æ¨¡æ¿ï¼ˆexamples/ï¼‰
- âŒ ä»…è‹±è¯­ï¼šCLI è¾“å‡ºã€ä»£ç æ³¨é‡Šã€é…ç½®æ–‡ä»¶æ³¨é‡Šã€GUIDE/QUICKSTART

### ğŸ“ ä»»åŠ¡æ¸…å•
- [ ] ç¼–å†™ `README.md` (è‹±æ–‡)
  - é¡¹ç›®ä»‹ç»å’Œä»·å€¼ä¸»å¼ 
  - **å¯è§†åŒ–æ¼”ç¤º**ï¼ˆå ä½ç¬¦ï¼‰ï¼š
    - `docs/assets/demo-plan-generation.gif` - è®¡åˆ’ç”Ÿæˆæµç¨‹
    - `docs/assets/demo-auto-continue.gif` - è‡ªåŠ¨ç»§ç»­æ¼”ç¤º
    - `docs/assets/demo-architecture-choice.gif` - æ¶æ„é€‰æ‹©
    - å ä½ç¬¦ï¼š`![Demo](docs/assets/demo-xxx.gif) <!-- TODO: Record GIF -->`
  - å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿä¸Šæ‰‹ï¼‰
  - æ ¸å¿ƒç‰¹æ€§åˆ—è¡¨ï¼ˆé‡ç‚¹çªå‡ºåˆ›æ–°ï¼‰ï¼š
    - **æ™ºèƒ½æ¶æ„é€‰æ‹©**ï¼šè‡ªåŠ¨åˆ¤æ–­æˆ–æ‰‹åŠ¨æŒ‡å®šæ‹†åˆ†/å•æ–‡ä»¶æ¶æ„
    - **é›¶äººå·¥å¹²é¢„**ï¼š--dangerously-skip-permissionsè‡ªåŠ¨è·³è¿‡æƒé™ç¡®è®¤
    - **ä»»åŠ¡æ¨¡æ¿ç³»ç»Ÿ**ï¼šå¿«é€Ÿå¼€å§‹å¸¸è§ä»»åŠ¡ç±»å‹
    - **å®Œå–„çš„è¯Šæ–­å·¥å…·**ï¼šdoctor å‘½ä»¤å¸®åŠ©æ’æŸ¥é—®é¢˜
  - å®‰è£…æ–¹æ³•
  - åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ï¼š
    - `/plan` é»˜è®¤è‡ªåŠ¨åˆ¤æ–­
    - `/plan --force-split` å¼ºåˆ¶æ‹†åˆ†
    - `/plan --template refactor` ä½¿ç”¨æ¨¡æ¿
  - æ¶æ„é€‰æ‹©æŒ‡å—ï¼ˆä½•æ—¶ç”¨æ‹†åˆ†ã€ä½•æ—¶ç”¨å•æ–‡ä»¶ï¼‰
  - é“¾æ¥åˆ°è¯¦ç»†æ–‡æ¡£
  - Badgeï¼ˆnpm version, license, etcï¼‰
- [ ] ç¼–å†™ `README_CN.md` (ä¸­æ–‡)
  - ä¸è‹±æ–‡ç‰ˆå¯¹åº”çš„æ‰€æœ‰å†…å®¹
  - åŒ…å«ç›¸åŒçš„ GIF å ä½ç¬¦
- [ ] ç¼–å†™ `docs/QUICKSTART.md` (ä»…è‹±è¯­)
  - è¯¦ç»†çš„å¿«é€Ÿå…¥é—¨æ•™ç¨‹
  - ä»é›¶åˆ°ç¬¬ä¸€ä¸ªè‡ªåŠ¨åŒ–ä»»åŠ¡
  - å¸¸è§é—®é¢˜è§£ç­”
  - åŒ…æ‹¬ doctor å‘½ä»¤ä½¿ç”¨
- [ ] ç¼–å†™ `docs/GUIDE.md` (ä»…è‹±è¯­)
  - å®Œæ•´ä½¿ç”¨æŒ‡å—
  - æ‰€æœ‰å‘½ä»¤è¯¦è§£ï¼ˆåŒ…æ‹¬æ–°å‘½ä»¤ï¼špause/resume/skip/retry/trigger/stats/migrateï¼‰
  - é«˜çº§åŠŸèƒ½ï¼ˆæ¨¡æ¿ã€é…ç½®ã€Hookï¼‰
  - æœ€ä½³å®è·µ
  - æ•…éšœæ’æŸ¥ï¼ˆä½¿ç”¨ doctorï¼‰
- [ ] ç¼–å†™ `docs/EXAMPLES.md` (ä»…è‹±è¯­)
  - çœŸå®åœºæ™¯æ¡ˆä¾‹
  - é‡æ„ã€æ–‡æ¡£ç”Ÿæˆã€æ–°åŠŸèƒ½å¼€å‘
  - æ¯ä¸ªæ¡ˆä¾‹åŒ…å«ï¼šèƒŒæ™¯ã€è®¡åˆ’ã€æ‰§è¡Œè¿‡ç¨‹ã€ç»“æœ
- [ ] åˆ›å»ºåŒè¯­ç¤ºä¾‹è®¡åˆ’ï¼ˆexamples/ï¼‰
  - `examples/refactor-auth/README.md` (ä¸­è‹±æ–‡åŒè¯­)
  - `examples/refactor-auth/README_EN.md`
  - `examples/api-documentation/README.md` (ä¸­è‹±æ–‡åŒè¯­)
  - `examples/api-documentation/README_EN.md`
  - `examples/config-update.md` (ä¸­è‹±æ–‡åŒè¯­ï¼Œå•æ–‡ä»¶)
  - ç¤ºä¾‹ä½œä¸ºæ¨¡æ¿å­¦ä¹ çš„èŒƒæœ¬
- [ ] ç¼–å†™ `CHANGELOG.md`
  - v2.0.0 å‘å¸ƒè¯´æ˜
  - ä¸v1.0çš„åŒºåˆ«
- [ ] ç¼–å†™ `CONTRIBUTING.md`
  - å¦‚ä½•è´¡çŒ®ä»£ç 
  - å¼€å‘ç¯å¢ƒè®¾ç½®
  - ä»£ç è§„èŒƒ
  - æäº¤PRæµç¨‹
- [ ] åˆ›å»º `LICENSE` æ–‡ä»¶ (MIT)
- [ ] åˆ›å»º `.github/` ç›®å½•
  - `ISSUE_TEMPLATE/bug_report.md`
  - `ISSUE_TEMPLATE/feature_request.md`
  - `PULL_REQUEST_TEMPLATE.md`
- [ ] æ›´æ–° `package.json`
  - å®Œæ•´çš„description, keywords
  - repository, bugs, homepage URL
  - authorä¿¡æ¯
- [ ] å‡†å¤‡npmå‘å¸ƒ
  - åˆ›å»º `.npmignore`
  - æµ‹è¯•æœ¬åœ°å®‰è£…ï¼š`npm link`
  - æµ‹è¯•å‘å¸ƒï¼š`npm publish --dry-run`
- [ ] å‡†å¤‡GitHub Topicsæ ‡ç­¾
  - claude-code, automation, ai-tools, developer-tools
  - workflow, productivity, nodejs

### âœ… å®Œæˆæ ‡å‡†
- [ ] READMEæ¸…æ™°æ˜“æ‡‚ï¼Œ5åˆ†é’Ÿèƒ½çœ‹æ˜ç™½
- [ ] **README åŒ…å« GIF å ä½ç¬¦**ï¼Œæ³¨é‡Šæ¸…æ¥šéœ€è¦å½•åˆ¶
- [ ] README çªå‡ºæ–°åŠŸèƒ½ï¼ˆæ¨¡æ¿ã€doctorã€pause/resumeç­‰ï¼‰
- [ ] **åŒè¯­èŒƒå›´æ˜ç¡®**ï¼šåªæœ‰ README å’Œ examples åŒè¯­ï¼Œå…¶ä»–ä»…è‹±è¯­
- [ ] README_CN.md ä¸ README.md å†…å®¹å¯¹ç­‰
- [ ] æ‰€æœ‰æ–‡æ¡£æ— æ‹¼å†™é”™è¯¯
- [ ] QUICKSTARTå¯ä»¥è®©æ–°æ‰‹æˆåŠŸå®Œæˆç¬¬ä¸€ä¸ªä»»åŠ¡ï¼ˆåŒ…å« doctorï¼‰
- [ ] GUIDEè¦†ç›–æ‰€æœ‰åŠŸèƒ½ï¼ˆåŒ…æ‹¬æ‰€æœ‰æ–°å‘½ä»¤ï¼‰
- [ ] ç¤ºä¾‹çœŸå®ä¸”é«˜è´¨é‡ï¼Œ**åŒè¯­ç‰ˆæœ¬å®Œæ•´**
- [ ] package.jsonä¿¡æ¯å®Œæ•´ï¼ŒåŒ…å«æ‰€æœ‰æ–°ä¾èµ–ï¼ˆajvï¼‰
- [ ] MIT Licenseæ­£ç¡®
- [ ] GitHubæ¨¡æ¿æ–‡ä»¶é½å…¨
- [ ] npmå‘å¸ƒæµ‹è¯•é€šè¿‡ï¼ˆåŒ…å« --dry-runï¼‰

### ğŸ“¤ é¢„æœŸè¾“å‡º
- [ ] `README.md` (1500-2000è¯ï¼Œå« GIF å ä½ç¬¦ï¼‰
- [ ] `README_CN.md` (1500-2000å­—ï¼Œå« GIF å ä½ç¬¦ï¼‰
- [ ] `docs/assets/` ç›®å½•ï¼ˆå ä½ç¬¦ï¼‰ï¼š
  - `.gitkeep` æˆ–å ä½è¯´æ˜
  - é¢„ç•™ demo-*.gif ä½ç½®
- [ ] `docs/QUICKSTART.md` (1000-1500è¯ï¼Œä»…è‹±è¯­ï¼‰
- [ ] `docs/GUIDE.md` (4000-5000è¯ï¼Œä»…è‹±è¯­ï¼Œæ–°å¢å‘½ä»¤æ–‡æ¡£ï¼‰
- [ ] `docs/EXAMPLES.md` (2000è¯ï¼Œä»…è‹±è¯­ï¼‰
- [ ] `examples/` ç›®å½•ï¼š
  - `refactor-auth/README.md` + `README_EN.md` (åŒè¯­)
  - `api-documentation/README.md` + `README_EN.md` (åŒè¯­)
  - `config-update.md` + `config-update_EN.md` (åŒè¯­)
- [ ] `CHANGELOG.md` (è‹±è¯­)
- [ ] `CONTRIBUTING.md` (è‹±è¯­)
- [ ] `LICENSE` (MIT)
- [ ] `.github/` ç›®å½•ä¸‹æ‰€æœ‰æ¨¡æ¿

### âš ï¸ æ³¨æ„äº‹é¡¹
- **æ˜ç¡®åŒè¯­èŒƒå›´**ï¼šåªæœ‰ README å’Œ examples åŒè¯­ï¼Œé¿å…ç»´æŠ¤è´Ÿæ‹…
- **GIF å ä½ç¬¦æ ¼å¼ç»Ÿä¸€**ï¼šä½¿ç”¨ `<!-- TODO: Record GIF -->` æ³¨é‡Š
- æ–‡æ¡£è¯­è¨€è¦ç®€æ´ã€å‹å¥½ã€ä¸“ä¸š
- ä¸­æ–‡é¿å…è¿‡åº¦ç¿»è¯‘è…”ï¼Œè¦è‡ªç„¶
- ç¤ºä¾‹è¦ç»è¿‡å®é™…æµ‹è¯•éªŒè¯
- READMEæ˜¯é¡¹ç›®é—¨é¢ï¼Œå¿…é¡»ç²¾å¿ƒæ‰“ç£¨
- **çªå‡ºæ–°åŠŸèƒ½**ï¼šæ¨¡æ¿ç³»ç»Ÿã€doctorã€pause/resumeã€statsã€migrate
- ç¡®ä¿æ‰€æœ‰é“¾æ¥æœ‰æ•ˆ
- è€ƒè™‘SEOï¼ˆnpmæœç´¢ã€GitHubæœç´¢ï¼‰
- **GUIDE å¿…é¡»å®Œæ•´**ï¼šè¦†ç›–æ‰€æœ‰æ–°å¢çš„å‘½ä»¤å’ŒåŠŸèƒ½
- examples ä½œä¸ºé«˜è´¨é‡èŒƒæœ¬ï¼Œéœ€ç²¾å¿ƒç¼–å†™

### ğŸ§ª éªŒè¯å‘½ä»¤
```bash
# æ£€æŸ¥markdownæ ¼å¼
npx markdownlint README.md

# æ£€æŸ¥æ‹¼å†™
npx cspell "**/*.md"

# æµ‹è¯•npmæ‰“åŒ…
npm pack

# æµ‹è¯•æœ¬åœ°å®‰è£…
npm link
ccautorun --version

# æ¨¡æ‹Ÿå‘å¸ƒ
npm publish --dry-run
```

---

## ğŸ“ v2.0 æ”¹è¿›æ€»ç»“

### æ–°å¢å‘½ä»¤ï¼ˆStage 2a & 2bï¼‰
- `ccautorun init --setup-hooks` - åˆå§‹åŒ–é¡¹ç›®å¹¶è‡ªåŠ¨é…ç½® Claude Code hooksï¼ˆ2aï¼Œå…³é”®ï¼ï¼‰
- `ccautorun edit <task>` - å¿«æ·ç¼–è¾‘ä»»åŠ¡è®¡åˆ’ï¼ˆ2aï¼‰
- `ccautorun validate <task>` - éªŒè¯è®¡åˆ’æ–‡æ¡£æ ¼å¼å’Œè´¨é‡ï¼ˆ2aï¼Œå…³é”®ï¼ï¼‰
- `ccautorun recover <task>` - é”™è¯¯æ¢å¤ï¼Œä» failed çŠ¶æ€æ¢å¤ï¼ˆ2aï¼Œå…³é”®ï¼ï¼‰
- `ccautorun watch <task>` - å®æ—¶è¿›åº¦ç›‘æ§å’Œå¯è§†åŒ–ï¼ˆStage 5ï¼Œå…³é”®ï¼ï¼‰
- `ccautorun doctor` - è¯Šæ–­å·¥å…·ï¼Œæ£€æŸ¥ç¯å¢ƒé…ç½®ï¼ˆ2aï¼‰
- `ccautorun pause <task>` - æš‚åœä»»åŠ¡è‡ªåŠ¨ç»§ç»­ï¼ˆ2bï¼‰
- `ccautorun resume <task>` - æ¢å¤ä»»åŠ¡è‡ªåŠ¨ç»§ç»­ï¼ˆ2bï¼‰
- `ccautorun skip <task> <stage>` - è·³è¿‡æŒ‡å®š Stageï¼ˆ2bï¼‰
- `ccautorun retry <task> [stage]` - é‡è¯•å¤±è´¥çš„ Stageï¼ˆ2bï¼‰
- `ccautorun logs <task>` - æŸ¥çœ‹ä»»åŠ¡æ—¥å¿—ï¼ˆ2bï¼‰
- `ccautorun stats` - æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼ˆ2bï¼‰
- `ccautorun trigger <task>` - æ‰‹åŠ¨è§¦å‘ä¸‹ä¸€ Stageï¼ˆStage 3ï¼‰
- `ccautorun migrate` - é…ç½®ç‰ˆæœ¬è¿ç§»ï¼ˆStage 5ï¼‰
- `ccautorun config --get/--set/--list` - å¢å¼ºé…ç½®å‘½ä»¤ï¼ˆStage 5ï¼‰

### è‡ªåŠ¨åŒ–å¢å¼ºï¼ˆStage 2aï¼‰
- **äº¤äº’å¼ Onboarding**ï¼šé¦–æ¬¡è¿è¡Œæ—¶çš„å¼•å¯¼æµç¨‹
  - æ¬¢è¿ç•Œé¢å’Œå¿«é€Ÿå¯åŠ¨é€‰é¡¹
  - è‡ªåŠ¨å¼•å¯¼ç”¨æˆ·å®Œæˆåˆå§‹åŒ–
- **Hook è‡ªåŠ¨é…ç½®**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - `--setup-hooks` è‡ªåŠ¨åˆ›å»ºå¹¶é…ç½® `.claude/hooks.yaml`
  - `--enable-hooks` è‡ªåŠ¨å¯ç”¨ auto-continue hook
  - æ™ºèƒ½æ£€æµ‹ç°æœ‰é…ç½®ï¼Œé¿å…è¦†ç›–

### æ ¸å¿ƒå¢å¼ºï¼ˆStage 3ï¼‰
- **Hook ä¸‰å±‚é™çº§ç­–ç•¥**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - ä¸»ç­–ç•¥ï¼šè§£æ transcript æœ€å 100 è¡Œï¼ŒåŒ¹é… `[STAGE_COMPLETE:N]` æ ‡è®°
  - é™çº§ç­–ç•¥1ï¼šæ£€æŸ¥ç‹¬ç«‹æ ‡è®°æ–‡ä»¶ï¼ˆ`.ccautorun/sessions/<task>.stage-complete`ï¼‰
  - é™çº§ç­–ç•¥2ï¼šæ£€æŸ¥è®¡åˆ’æ–‡æ¡£ä¿®æ”¹æ—¶é—´ï¼ˆ15ç§’å†…ä¿®æ”¹è§†ä¸ºå®Œæˆï¼‰
  - æœ€ç»ˆé™çº§ï¼šå‘é€æ¡Œé¢é€šçŸ¥æé†’ç”¨æˆ·æ‰‹åŠ¨ç»§ç»­
- **ä»»åŠ¡å¤±è´¥çŠ¶æ€æ”¯æŒ**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - æ–°å¢ `failed` çŠ¶æ€ï¼Œè®°å½• `lastError` å­—æ®µ
  - æ£€æµ‹é”™è¯¯æ¨¡å¼ï¼ˆerror/failed/exception ç­‰ï¼‰
  - ä¸¥é‡é”™è¯¯æ—¶åœæ­¢è‡ªåŠ¨ç»§ç»­ï¼Œå‘é€é€šçŸ¥
  - æç¤ºç”¨æˆ·ä½¿ç”¨ `retry` æˆ– `recover` å‘½ä»¤
- **åŸå­å†™å…¥æœºåˆ¶**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - å…ˆå†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼ˆ`.json.tmp`ï¼‰
  - ä½¿ç”¨ `fs.renameSync()` åŸå­æ›¿æ¢
  - é¿å…æ•°æ®æŸåï¼Œç¡®ä¿ä¼šè¯çŠ¶æ€ä¸€è‡´æ€§
- **session-manager ç®€åŒ–**ï¼šä» 150 è¡Œç®€åŒ–ä¸º 60 è¡Œ
- **Stage æ–‡ä»¶åå¼ºåˆ¶ç²¾ç¡®åŒ¹é…**ï¼šé¿å… backup æ–‡ä»¶å†²çª

### AI æµç¨‹æ”¹è¿›ï¼ˆStage 4ï¼‰
- **ç§»é™¤å‚æ•°é¢„å¤„ç†å™¨**ï¼šç®€åŒ–æ¶æ„ï¼Œç›´æ¥åœ¨ slash command ä¸­è§£æå‚æ•°
- **Phase 6 éªŒè¯é›†æˆ**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - AI è°ƒç”¨ `ccautorun validate` å‘½ä»¤éªŒè¯è®¡åˆ’è´¨é‡
  - æ£€æŸ¥é…ç½®å¤´ã€æ–‡ä»¶å‘½åã€å†…å®¹ç»“æ„
  - æ£€æŸ¥ Token æ•ˆç‡ï¼ˆæ‹†åˆ†æ¶æ„ < 1500 tokens/stageï¼‰
  - éªŒè¯å¤±è´¥æ—¶æä¾›ä¿®å¤å»ºè®®
- **æ¨¡æ¿ç³»ç»Ÿ**ï¼šæ”¯æŒä»»åŠ¡æ¨¡æ¿ï¼ˆrefactor/feature/bugfix/docsï¼‰
- **åŒæ¶æ„æ”¯æŒå®Œå–„**ï¼šAI è‡ªåŠ¨åˆ¤æ–­ + ç”¨æˆ·å¼ºåˆ¶æŒ‡å®š

### ç”¨æˆ·ä½“éªŒæå‡ï¼ˆStage 5ï¼‰
- **å®æ—¶è¿›åº¦ç›‘æ§**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - `watch` å‘½ä»¤é»˜è®¤å¼€å¯ï¼ˆæ‰§è¡Œä»»åŠ¡æ—¶è‡ªåŠ¨å¯åŠ¨ï¼‰
  - æ˜¾ç¤ºè¿›åº¦æ¡ã€ç™¾åˆ†æ¯”ã€å·²ç”¨æ—¶é—´ã€é¢„è®¡å‰©ä½™æ—¶é—´
  - ä½¿ç”¨ chokidar ç›‘æ§æ–‡ä»¶å˜åŒ–ï¼Œå®æ—¶æ›´æ–°
  - çŠ¶æ€å˜åŒ–é€šçŸ¥ï¼ˆStage å®Œæˆ/é”™è¯¯/ä»»åŠ¡å®Œæˆï¼‰
- **é€šçŸ¥ç³»ç»Ÿå¢å¼º**ï¼š
  - ç»Ÿä¸€é€šçŸ¥æ¥å£ï¼ˆprogress/error/complete/warningï¼‰
  - é›†æˆåˆ° Hookï¼Œè‡ªåŠ¨å‘é€é€šçŸ¥
  - å¯é…ç½®é€šçŸ¥é¢‘ç‡
- **æ—¥å¿—è½®è½¬**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - ä½¿ç”¨ winston-daily-rotate-file
  - æœ€å¤šä¿ç•™ 30 å¤©æˆ– 100MB
  - æŒ‰æ—¥æœŸå½’æ¡£ï¼ˆexecution-2025-01-06.logï¼‰
- **é…ç½®ç®¡ç†å¢å¼º**ï¼š
  - æ”¯æŒ --get/--set/--list
  - äº¤äº’å¼é…ç½®å‘å¯¼
  - é…ç½®éªŒè¯ï¼ˆajvï¼‰
- **ç‰ˆæœ¬ç®¡ç†**ï¼š
  - config.yaml åŒ…å« version å­—æ®µ
  - è‡ªåŠ¨è¿ç§»å‘½ä»¤
  - å¯åŠ¨æ—¶ç‰ˆæœ¬æ£€æŸ¥
- **æ‰€æœ‰å‘½ä»¤æ”¯æŒ --dry-run**ï¼šé¢„è§ˆæ“ä½œè€Œä¸æ‰§è¡Œ

### æµ‹è¯•åŸºç¡€è®¾æ–½ï¼ˆStage 5.5ï¼Œæ–°å¢ï¼‰
- **å®Œæ•´æµ‹è¯•è¦†ç›–**ï¼ˆ70%+ï¼‰ï¼š
  - å•å…ƒæµ‹è¯•ï¼šplan-parser, session-manager, safety-limiter ç­‰ï¼ˆ51+ ç”¨ä¾‹ï¼‰
  - é›†æˆæµ‹è¯•ï¼šæ‰€æœ‰ CLI å‘½ä»¤ï¼ˆ36+ ç”¨ä¾‹ï¼‰
  - Hook æµ‹è¯•ï¼šä¸‰å±‚é™çº§ç­–ç•¥ã€é”™è¯¯æ£€æµ‹ç­‰ï¼ˆ15+ ç”¨ä¾‹ï¼‰
  - E2E æµ‹è¯•ï¼šå®Œæ•´å·¥ä½œæµï¼ˆ3+ ç”¨ä¾‹ï¼‰
- **Vitest é…ç½®**ï¼š
  - ES Modules æ”¯æŒ
  - è¦†ç›–ç‡æŠ¥å‘Šï¼ˆv8ï¼‰
  - Watch æ¨¡å¼å’Œ UI ç•Œé¢
  - æ€»è®¡ 105+ æµ‹è¯•ç”¨ä¾‹ï¼Œ~3,800 è¡Œæµ‹è¯•ä»£ç 

### æ–‡æ¡£æ”¹è¿›ï¼ˆStage 7ï¼‰
- **æ˜ç¡®åŒè¯­èŒƒå›´**ï¼šåªæœ‰ README å’Œ examples åŒè¯­
- **GIF æ¼”ç¤ºå ä½ç¬¦**ï¼šé¢„ç•™å¯è§†åŒ–æ¼”ç¤ºä½ç½®
- **å®Œæ•´çš„å‘½ä»¤æ–‡æ¡£**ï¼šè¦†ç›–æ‰€æœ‰æ–°å¢å‘½ä»¤ï¼ˆ15 ä¸ªæ–°å‘½ä»¤ï¼‰

### åˆ é™¤åŠŸèƒ½
- **åˆ é™¤ monitor å‘½ä»¤**ï¼šé€šçŸ¥åŠŸèƒ½å†…ç½®åˆ° Hookï¼Œæ— éœ€å•ç‹¬å‘½ä»¤
- **åˆ é™¤å‚æ•°é¢„å¤„ç†å™¨**ï¼šç®€åŒ–æ¶æ„ï¼Œç›´æ¥åœ¨ slash command ä¸­å¤„ç†

### è®¾è®¡å†³ç­–
- **å¹¶å‘æ§åˆ¶**ï¼šä¸æ·»åŠ æ–‡ä»¶é”ï¼Œå¤æ‚åº¦è¿‡é«˜ï¼Œåœºæ™¯æå°‘
- **ä¼šè¯å­˜å‚¨**ï¼šä¸ä½¿ç”¨ SQLiteï¼Œä½¿ç”¨åŸå­æ–‡ä»¶å†™å…¥ï¼ˆå…¼å®¹æ€§æ›´å¥½ï¼‰
- **ç‰ˆæœ¬è¿ç§»**ï¼šç®€å•å¤„ç†ï¼Œåªå¤„ç†å­—æ®µæ·»åŠ 
- **æ¨¡æ¿ç³»ç»Ÿ**ï¼šä½¿ç”¨ slash command è€Œé CLI
- **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€ä½¿ç”¨ error-handlerï¼ŒåŒ…å«é”™è¯¯ç å’Œä¿®å¤å»ºè®®
- **æµ‹è¯•å·¥å…·**ï¼šä½¿ç”¨ Vitestï¼ˆè€Œé Jestï¼‰ï¼Œæ›´å¿«ä¸”å¯¹ ES Modules æ”¯æŒæ›´å¥½

---

## ğŸ‰ æœ€ç»ˆæ£€æŸ¥æ¸…å•

### åŠŸèƒ½å®Œæ•´æ€§
- [ ] æ‰€æœ‰ 7 ä¸ªé˜¶æ®µå®Œæˆï¼ˆStage 1 åˆ° Stage 7ï¼ŒåŒ…æ‹¬ Stage 5.5ï¼‰
- [ ] **æ‰€æœ‰ 15 ä¸ªæ–°å¢å‘½ä»¤å®ç°å¹¶æµ‹è¯•**ï¼š
  - [ ] init --setup-hooks / --enable-hooksï¼ˆhook è‡ªåŠ¨é…ç½®ï¼‰
  - [ ] editï¼ˆå¿«æ·ç¼–è¾‘ï¼‰
  - [ ] validateï¼ˆè®¡åˆ’éªŒè¯ï¼Œå…³é”®ï¼ï¼‰
  - [ ] recoverï¼ˆé”™è¯¯æ¢å¤ï¼Œå…³é”®ï¼ï¼‰
  - [ ] watchï¼ˆå®æ—¶è¿›åº¦ç›‘æ§ï¼Œå…³é”®ï¼ï¼‰
  - [ ] doctorï¼ˆè¯Šæ–­å·¥å…·ï¼‰
  - [ ] pause/resumeï¼ˆæš‚åœæ¢å¤ï¼‰
  - [ ] skipï¼ˆè·³è¿‡ Stageï¼‰
  - [ ] retryï¼ˆé‡è¯•å¤±è´¥ï¼‰
  - [ ] logsï¼ˆæŸ¥çœ‹æ—¥å¿—ï¼‰
  - [ ] statsï¼ˆç»Ÿè®¡ä¿¡æ¯ï¼‰
  - [ ] triggerï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰
  - [ ] migrateï¼ˆé…ç½®è¿ç§»ï¼‰
  - [ ] config --get/--set/--listï¼ˆé…ç½®ç®¡ç†ï¼‰
- [ ] **Hook ä¸‰å±‚é™çº§ç­–ç•¥éªŒè¯**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - [ ] ä¸»ç­–ç•¥ï¼štranscript æ ‡è®°æ£€æµ‹
  - [ ] é™çº§1ï¼šç‹¬ç«‹æ ‡è®°æ–‡ä»¶
  - [ ] é™çº§2ï¼šæ–‡ä»¶ä¿®æ”¹æ—¶é—´
  - [ ] æœ€ç»ˆé™çº§ï¼šç”¨æˆ·é€šçŸ¥
- [ ] **ä»»åŠ¡å¤±è´¥çŠ¶æ€æ”¯æŒéªŒè¯**ï¼ˆå…³é”®ï¼ï¼‰ï¼š
  - [ ] failed çŠ¶æ€è®°å½•å’Œ lastError å­—æ®µ
  - [ ] é”™è¯¯æ£€æµ‹å’Œè‡ªåŠ¨åœæ­¢
  - [ ] recover å’Œ retry å‘½ä»¤æ¢å¤
- [ ] **åŸå­å†™å…¥æœºåˆ¶éªŒè¯**ï¼štmp + rename å·¥ä½œæ­£å¸¸
- [ ] **Phase 6 éªŒè¯é›†æˆ**ï¼šAI è°ƒç”¨ validate å‘½ä»¤
- [ ] æ¨¡æ¿ç³»ç»Ÿå¯ç”¨ï¼ˆ4ä¸ªæ¨¡æ¿ï¼šrefactor/feature/bugfix/docsï¼‰
- [ ] é…ç½®éªŒè¯å·¥ä½œæ­£å¸¸ï¼ˆajvï¼‰
- [ ] ç‰ˆæœ¬è¿ç§»æµ‹è¯•é€šè¿‡
- [ ] **é€šçŸ¥ç³»ç»Ÿåœ¨ Hook ä¸­æ­£å¸¸å·¥ä½œ**ï¼š
  - [ ] progress/error/complete/warning é€šçŸ¥
  - [ ] å¯é…ç½®é¢‘ç‡
- [ ] **æ—¥å¿—è½®è½¬å·¥ä½œæ­£å¸¸**ï¼ˆwinston-daily-rotate-fileï¼‰
- [ ] **watch å‘½ä»¤å®æ—¶ç›‘æ§**ï¼ˆé»˜è®¤å¼€å¯ï¼‰
- [ ] **æ‰€æœ‰å‘½ä»¤ --dry-run æ”¯æŒ**

### ä»£ç è´¨é‡
- [ ] ä»£ç è´¨é‡æ£€æŸ¥é€šè¿‡ï¼ˆESLintï¼‰
- [ ] session-manager å·²ç®€åŒ–ï¼ˆçº¦60è¡Œï¼‰
- [ ] é”™è¯¯å¤„ç†ç»Ÿä¸€ä½¿ç”¨ error-handler
- [ ] Windows å…¼å®¹æ€§éªŒè¯ï¼ˆä½¿ç”¨ Node.js APIï¼‰
- [ ] æ—  SQLite ä¾èµ–ï¼ˆä½¿ç”¨åŸå­æ–‡ä»¶å†™å…¥ï¼‰

### æµ‹è¯•å®Œæ•´æ€§ï¼ˆStage 5.5ï¼‰
- [ ] **Vitest é…ç½®å®Œæˆ**
- [ ] **105+ æµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡**ï¼š
  - [ ] å•å…ƒæµ‹è¯•ï¼ˆ51+ ç”¨ä¾‹ï¼‰
  - [ ] é›†æˆæµ‹è¯•ï¼ˆ36+ ç”¨ä¾‹ï¼‰
  - [ ] Hook æµ‹è¯•ï¼ˆ15+ ç”¨ä¾‹ï¼ŒåŒ…æ‹¬ä¸‰å±‚é™çº§ï¼‰
  - [ ] E2E æµ‹è¯•ï¼ˆ3+ ç”¨ä¾‹ï¼‰
- [ ] **æµ‹è¯•è¦†ç›–ç‡è¾¾åˆ° 70%+**
- [ ] è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆæ­£å¸¸
- [ ] æ‰€æœ‰æµ‹è¯•åœ¨ CI ç¯å¢ƒå¯è¿è¡Œ
- [ ] æµ‹è¯•è¿è¡Œæ—¶é—´ < 30 ç§’ï¼ˆä¸å« E2Eï¼‰
- [ ] æ²¡æœ‰ flaky tests

### æ–‡æ¡£å®Œæ•´æ€§
- [ ] README.md å’Œ README_CN.md å®Œæ•´ï¼ˆå« GIF å ä½ç¬¦ï¼‰
- [ ] QUICKSTART.md å’Œ GUIDE.md å®Œæ•´ï¼ˆä»…è‹±è¯­ï¼‰
- [ ] examples åŒè¯­ç‰ˆæœ¬å®Œæ•´ï¼ˆ3ä¸ªç¤ºä¾‹ï¼‰
- [ ] **æ‰€æœ‰ 15 ä¸ªæ–°å‘½ä»¤åœ¨ GUIDE ä¸­æœ‰æ–‡æ¡£**
- [ ] CHANGELOG.md è®°å½•æ‰€æœ‰æ”¹è¿›ï¼ˆåŒ…æ‹¬æµ‹è¯•ã€æ–°å‘½ä»¤ã€ä¸‰å±‚é™çº§ç­‰ï¼‰

### çœŸå®åœºæ™¯éªŒè¯
- [ ] åœ¨ Mac/Win/Linux ä¸Šæµ‹è¯•è¿‡
- [ ] npm æœ¬åœ°å®‰è£…æµ‹è¯•é€šè¿‡ï¼ˆnpm linkï¼‰
- [ ] npm å‘å¸ƒæµ‹è¯•é€šè¿‡ï¼ˆ--dry-runï¼‰
- [ ] **å®Œæ•´å·¥ä½œæµæµ‹è¯•**ï¼š
  - [ ] init --setup-hooks è‡ªåŠ¨é…ç½®
  - [ ] /plan ç”Ÿæˆè®¡åˆ’ï¼ˆæ‹†åˆ†æ¶æ„ï¼‰
  - [ ] validate éªŒè¯è®¡åˆ’
  - [ ] æ‰§è¡Œä»»åŠ¡ï¼ˆwatch å®æ—¶ç›‘æ§ï¼‰
  - [ ] Hook ä¸‰å±‚é™çº§ç­–ç•¥
  - [ ] é”™è¯¯æ¢å¤ï¼ˆrecover/retryï¼‰
  - [ ] ä»»åŠ¡å®Œæˆ
- [ ] **Hook é™çº§ç­–ç•¥æµ‹è¯•**ï¼ˆ3 å±‚å…¨éƒ¨éªŒè¯ï¼‰
- [ ] **failed çŠ¶æ€æµ‹è¯•**ï¼ˆé”™è¯¯æ£€æµ‹å’Œæ¢å¤ï¼‰
- [ ] **åŸå­å†™å…¥æµ‹è¯•**ï¼ˆå¹¶å‘å®‰å…¨æ€§ï¼‰
- [ ] **æ—¥å¿—è½®è½¬æµ‹è¯•**ï¼ˆé•¿æ—¶é—´è¿è¡Œï¼‰
- [ ] é…ç½®è¿ç§»æµ‹è¯•ï¼ˆæ—§ç‰ˆæœ¬ â†’ v2.0ï¼‰
- [ ] ä½¿ç”¨æ¨¡æ¿ç”Ÿæˆè®¡åˆ’ï¼ˆrefactor/feature/bugfix/docsï¼‰
- [ ] doctor è¯Šæ–­æ‰€æœ‰é—®é¢˜ç±»å‹

### å‘å¸ƒå‡†å¤‡
- [ ] Git å†å²æ¸…æ™°ï¼ˆæ¯ä¸ª Stage ä¸€ä¸ª commitï¼‰
- [ ] package.json åŒ…å«æ‰€æœ‰ä¾èµ–ï¼š
  - [ ] commander, chokidar, node-notifier, yaml, chalk, ora, inquirer, glob, ajv
  - [ ] winston, winston-daily-rotate-file
  - [ ] vitest, @vitest/uiï¼ˆdevDependenciesï¼‰
- [ ] .npmignore æ­£ç¡®ï¼ˆæ’é™¤ tests/, docs/, examples/ï¼‰
- [ ] GitHub Topics æ ‡ç­¾è®¾ç½®
- [ ] CI/CD é…ç½®ï¼ˆGitHub Actions for testsï¼‰
- [ ] å‡†å¤‡å¥½å‘å¸ƒåˆ° GitHub
- [ ] å‡†å¤‡å¥½å‘å¸ƒåˆ° npm

---

## ğŸ“ ä½¿ç”¨è¯´æ˜

### æ‰§è¡Œæ–¹å¼ï¼ˆæ‰‹åŠ¨å¤šçª—å£ï¼‰

ç”±äºä¼šè¯ä¸Šä¸‹æ–‡é™åˆ¶ï¼Œå»ºè®®ï¼š

1. **ç¬¬ä¸€ä¸ªä¼šè¯** - Stage 1
   ```
   @EXECUTION_PLAN.md è¯·æ‰§è¡ŒStage 1
   ```

2. **ç¬¬äºŒä¸ªä¼šè¯** - Stage 2ï¼ˆæ–°çª—å£ï¼‰
   ```
   @EXECUTION_PLAN.md è¯·æ‰§è¡ŒStage 2
   ```

3. ä¾æ¬¡ç±»æ¨...

### æ¯ä¸ªStageå®Œæˆå

```bash
# æµ‹è¯•éªŒè¯
[è¿è¡ŒéªŒè¯å‘½ä»¤]

# Gitæäº¤
git add .
git commit -m "feat(stage-N): [ç®€è¦æè¿°]"
```

### é‡åˆ°é—®é¢˜æ—¶

1. è¿è¡Œè¯Šæ–­ï¼š`ccautorun doctor`
2. æŸ¥çœ‹æ—¥å¿—ï¼š`ccautorun logs <task-name>` æˆ– `tail -f .ccautorun/logs/execution.log`
3. æ£€æŸ¥çŠ¶æ€ï¼š`ccautorun status <task-name>`
4. åœ¨æ–°çª—å£è¯·æ±‚å¸®åŠ©ï¼Œ@è¿™ä¸ªè®¡åˆ’æ–‡æ¡£

### é‡è¦æé†’

**é¿å…å¹¶å‘æ“ä½œ**ï¼š
- ä¸è¦åœ¨å¤šä¸ª Claude Code ä¼šè¯ä¸­åŒæ—¶æ“ä½œåŒä¸€ä»»åŠ¡
- å¦‚æœå¿…é¡»åˆ‡æ¢ä¼šè¯ï¼Œå…ˆä½¿ç”¨ `ccautorun pause <task>` æš‚åœ
- åˆ‡æ¢å›æ¥åä½¿ç”¨ `ccautorun resume <task>` æ¢å¤
- è™½ç„¶æ²¡æœ‰æ–‡ä»¶é”ä¿æŠ¤ï¼Œä½†æ­£å¸¸ä½¿ç”¨ä¸ä¼šæœ‰é—®é¢˜

---

## ğŸ”§ æŠ€æœ¯å†³ç­–è®°å½•

### ä¸ºä»€ä¹ˆçº¯Node.jsï¼Ÿ
- âœ… è·¨å¹³å°ä¸€è‡´æ€§
- âœ… npmç”Ÿæ€ä¸°å¯Œ
- âœ… æ˜“äºåˆ†å‘å’Œå®‰è£…
- âœ… ç»´æŠ¤æˆæœ¬ä½

### ä¸ºä»€ä¹ˆç§»é™¤Slashæ¨¡å¼ï¼Ÿ
- âœ… Hookæ¨¡å¼æ›´å½»åº•è‡ªåŠ¨åŒ–
- âœ… å‡å°‘å®ç°å¤æ‚åº¦
- âœ… æ›´æ˜“ç†è§£å’Œç»´æŠ¤

### ä¸ºä»€ä¹ˆ `/plan` æ˜¯æ ¸å¿ƒï¼Ÿ
- âœ… é«˜è´¨é‡è®¡åˆ’æ˜¯è‡ªåŠ¨åŒ–æˆåŠŸçš„å‰æ
- âœ… AIç”Ÿæˆ > æ‰‹åŠ¨ç¼–å†™
- âœ… é™ä½ç”¨æˆ·é—¨æ§›

### ä¸ºä»€ä¹ˆä»»åŠ¡é©±åŠ¨è€Œéé¡¹ç›®é©±åŠ¨ï¼Ÿ
- âœ… æ›´ç¬¦åˆçœŸå®åœºæ™¯ï¼ˆç°æœ‰é¡¹ç›®çš„å…·ä½“ä»»åŠ¡ï¼‰
- âœ… æ”¯æŒå¤šä»»åŠ¡å¹¶è¡Œ
- âœ… çµæ´»æ€§æ›´é«˜

### ä¸ºä»€ä¹ˆæ”¯æŒåŒæ¶æ„ï¼ˆæ‹†åˆ†+å•æ–‡ä»¶ï¼‰ï¼Ÿ
- âœ… **çµæ´»æ€§**ï¼šç®€å•ä»»åŠ¡ç”¨å•æ–‡ä»¶æ›´ç›´æ¥ï¼Œå¤æ‚ä»»åŠ¡ç”¨æ‹†åˆ†æ›´é«˜æ•ˆ
- âœ… **Tokenæ•ˆç‡**ï¼šæ‹†åˆ†æ¶æ„èŠ‚çœ90%+ tokenï¼ˆåªåŠ è½½å½“å‰stageï¼‰
- âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šAIè‡ªåŠ¨åˆ¤æ–­ + ç”¨æˆ·å¯å¼ºåˆ¶æŒ‡å®š = æœ€ä½³å¹³è¡¡
- âœ… **å‘åå…¼å®¹**ï¼šæ”¯æŒç°æœ‰å•æ–‡ä»¶è®¡åˆ’ï¼Œå¹³æ»‘è¿ç§»
- âŒ **ä¸å¼ºåˆ¶æ‹†åˆ†**ï¼šé¿å…ä¸ºç®€å•ä»»åŠ¡å¢åŠ ä¸å¿…è¦çš„å¤æ‚åº¦

åˆ¤æ–­æ ‡å‡†ï¼š
- **å•æ–‡ä»¶é€‚åˆ**ï¼šStageâ‰¤3, æ€»è¡Œæ•°<2500, ä»»åŠ¡ç®€å•ï¼ˆé…ç½®æ›´æ–°ã€æ–‡æ¡£ç”Ÿæˆç­‰ï¼‰
- **æ‹†åˆ†æ¶æ„é€‚åˆ**ï¼šStage>3, æ€»è¡Œæ•°â‰¥2500, ä»»åŠ¡å¤æ‚ï¼ˆé‡æ„ã€æ–°åŠŸèƒ½å¼€å‘ç­‰ï¼‰

### ä¸ºä»€ä¹ˆä½¿ç”¨ --dangerously-skip-permissionsï¼Ÿ
- âœ… **è‡ªåŠ¨åŒ–æ ¸å¿ƒ**ï¼šæ²¡æœ‰è¿™ä¸ªï¼ŒHookè‡ªåŠ¨ç»§ç»­ä¼šè¢«æƒé™å¼¹çª—ä¸­æ–­
- âœ… **ç”¨æˆ·å·²æˆæƒ**ï¼šç”¨æˆ·æ‰‹åŠ¨å¯åŠ¨ç¬¬ä¸€ä¸ªstage = ä¿¡ä»»æ•´ä¸ªè®¡åˆ’
- âœ… **å¯é…ç½®**ï¼šæ‹…å¿ƒå®‰å…¨çš„ç”¨æˆ·å¯ä»¥å…³é—­ï¼ˆä½†ä¼šå¤±å»è‡ªåŠ¨åŒ–ï¼‰
- âš ï¸  **å®‰å…¨è¾¹ç•Œæ¸…æ™°**ï¼š
  - âœ… å…è®¸ï¼šè®¡åˆ’æ–‡æ¡£æ¥è‡ªç”¨æˆ·è‡ªå·±æˆ–å¯ä¿¡æº
  - âŒ ç¦æ­¢ï¼šæ‰§è¡Œæœªç»å®¡æŸ¥çš„ç¬¬ä¸‰æ–¹è®¡åˆ’
  - ğŸ“ æ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜å®‰å…¨æ³¨æ„äº‹é¡¹

---

**å‡†å¤‡å¼€å§‹æ‰§è¡ŒStage 1äº†å—ï¼Ÿ**
